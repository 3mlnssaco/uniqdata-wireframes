# AI ì—°êµ¬ ì„¤ê³„ ì–´ì‹œìŠ¤í„´íŠ¸ ìŠ¤í™

## ê°œìš”

ì—°êµ¬ ì„¤ê³„ í™”ë©´(Step 1~6)ì—ì„œ AIì™€ ëŒ€í™”í•˜ë©° í¼ì„ ìë™ìœ¼ë¡œ ì±„ìš°ëŠ” ê¸°ëŠ¥.

---

## UI êµ¬ì¡°

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  [ì‚¬ì´ë“œë°”]  â”‚         [ë©”ì¸ í¼]          â”‚    [AI ì±„íŒ… íŒ¨ë„]           â”‚
â”‚             â”‚                            â”‚                             â”‚
â”‚  â—‹ í™ˆ       â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚  ğŸ¤– AI ì—°êµ¬ ì„¤ê³„ ì–´ì‹œìŠ¤í„´íŠ¸  â”‚
â”‚  â—‹ ì—°êµ¬ê´€ë¦¬  â”‚  â”‚ Step 2: ì„¤ê³„ í™•ì¸    â”‚   â”‚                             â”‚
â”‚  â—‹ Data Poolâ”‚  â”‚                     â”‚   â”‚  [í˜„ì¬ ì—°êµ¬ ì»¨í…ìŠ¤íŠ¸]        â”‚
â”‚  â—‹ íŒ€       â”‚  â”‚ ì—°ë ¹: [40] ~ [70]   â”‚â—€â”€â”€â”‚  ë‹¹ë‡¨ ë³µì•½ ìˆœì‘ë„ ì—°êµ¬       â”‚
â”‚  â—‹ ê²°ì œ     â”‚  â”‚ ì§ˆí™˜: â—ë‹¹ë‡¨ â—‹ê³ í˜ˆì••  â”‚   â”‚  40-70ì„¸ | ë‹¹ë‡¨ | 6ê°œ ë°ì´í„°â”‚
â”‚             â”‚  â”‚                     â”‚   â”‚                             â”‚
â”‚             â”‚  â”‚ [ì´ì „] [ë‹¤ìŒ]       â”‚   â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€   â”‚
â”‚             â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚                             â”‚
â”‚             â”‚                            â”‚  ğŸ¤– ì–´ë–¤ ì„¤ì •ì´ í•„ìš”í•˜ì‹ ê°€ìš”? â”‚
â”‚             â”‚                            â”‚                             â”‚
â”‚             â”‚                            â”‚  ğŸ‘¤ 40ëŒ€ ì´ìƒë§Œ ëª¨ì§‘í•´ì¤˜     â”‚
â”‚             â”‚                            â”‚                             â”‚
â”‚             â”‚                            â”‚  ğŸ¤– ì°¸ì—¬ ì¡°ê±´ì„ ì„¤ì •í–ˆìŠµë‹ˆë‹¤: â”‚
â”‚             â”‚                            â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚             â”‚                            â”‚  â”‚ âœ“ ì—°ë ¹: 40ì„¸ ì´ìƒ       â”‚ â”‚
â”‚             â”‚                            â”‚  â”‚ [ì ìš©ë¨] [ë˜ëŒë¦¬ê¸°]     â”‚ â”‚
â”‚             â”‚                            â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚             â”‚                            â”‚                             â”‚
â”‚             â”‚                            â”‚  [ë¹ ë¥¸ ì„¤ì • ì¹©ë“¤]           â”‚
â”‚             â”‚                            â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚             â”‚                            â”‚  â”‚  [ì…ë ¥]         [â¤]  â”‚   â”‚
â”‚             â”‚                            â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## AI ì²˜ë¦¬ í”Œë¡œìš°

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                                                                â”‚
â”‚  [ì‚¬ìš©ì ì…ë ¥]                                                  â”‚
â”‚      â”‚                                                         â”‚
â”‚      â–¼                                                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                           â”‚
â”‚  â”‚  í”„ë¡ íŠ¸ì—”ë“œ NLU â”‚  â† ê°„ë‹¨í•œ íŒ¨í„´ ë§¤ì¹­ (ì˜¤í”„ë¼ì¸)             â”‚
â”‚  â”‚  (ë¡œì»¬ íŒŒì‹±)    â”‚                                           â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                           â”‚
â”‚           â”‚                                                    â”‚
â”‚           â–¼                                                    â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                   â”‚
â”‚  â”‚  ì˜ë„ ë¶„ë¥˜      â”‚â”€â”€â”€â”€â–¶â”‚  ë³µì¡í•œ ìš”ì²­    â”‚                   â”‚
â”‚  â”‚  (Intent)       â”‚     â”‚  â†’ ë°±ì—”ë“œ LLM   â”‚                   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜                   â”‚
â”‚           â”‚ ë‹¨ìˆœ ìš”ì²­              â”‚                           â”‚
â”‚           â–¼                        â–¼                           â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                   â”‚
â”‚  â”‚  ë¡œì»¬ ì•¡ì…˜ ì‹¤í–‰ â”‚     â”‚  LLM ì‘ë‹µ íŒŒì‹±  â”‚                   â”‚
â”‚  â”‚  (í¼ ì—…ë°ì´íŠ¸)  â”‚     â”‚  â†’ ì•¡ì…˜ ì¶”ì¶œ    â”‚                   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜                   â”‚
â”‚           â”‚                        â”‚                           â”‚
â”‚           â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                           â”‚
â”‚                        â–¼                                       â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                   â”‚
â”‚  â”‚  DOM ì—…ë°ì´íŠ¸ + ë³€ê²½ ì´ë ¥ ì €ì¥          â”‚                   â”‚
â”‚  â”‚  (undo ì§€ì›)                            â”‚                   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                   â”‚
â”‚                                                                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ì§€ì› ì˜ë„ (Intent) ëª©ë¡

### Step 2: ì„¤ê³„ í™•ì¸

| ì˜ë„ | ì˜ˆì‹œ ë°œí™” | ì•¡ì…˜ |
|------|----------|------|
| `set_methodology` | "RCTë¡œ ë°”ê¿”ì¤˜", "ì½”í˜¸íŠ¸ ì—°êµ¬ë¡œ í•´" | ë°©ë²•ë¡  ì„ íƒ í† ê¸€ |
| `set_age_range` | "40ëŒ€ ì´ìƒë§Œ", "30~50ì„¸" | ì—°ë ¹ ì…ë ¥ í•„ë“œ ì—…ë°ì´íŠ¸ |
| `set_condition` | "ë‹¹ë‡¨ í™˜ìë§Œ", "ê³ í˜ˆì•• ì¶”ê°€í•´" | ì¡°ê±´ ì¹© ì„ íƒ/í•´ì œ |
| `set_duration` | "60ì¼ë¡œ í•´ì¤˜", "ê¸°ê°„ ëŠ˜ë ¤ì¤˜" | ê¸°ê°„ í•„ë“œ ì—…ë°ì´íŠ¸ |
| `set_participants` | "100ëª… ëª¨ì§‘", "ëª©í‘œ ì¸ì› ëŠ˜ë ¤" | ì°¸ì—¬ì ìˆ˜ ì—…ë°ì´íŠ¸ |

### Step 3: ë°ì´í„° ìˆ˜ì§‘

| ì˜ë„ | ì˜ˆì‹œ ë°œí™” | ì•¡ì…˜ |
|------|----------|------|
| `select_data` | "CGM ì¶”ê°€í•´", "ì‹¬ë°•ìˆ˜ë„ í•„ìš”í•´" | ë°ì´í„° í•­ëª© ì„ íƒ |
| `deselect_data` | "ìˆ˜ë©´ì€ ë¹¼ì¤˜", "ìœ„ì¹˜ ë°ì´í„° ì‚­ì œ" | ë°ì´í„° í•­ëª© í•´ì œ |
| `set_ema_frequency` | "ì‹ë‹¨ì€ í•˜ë£¨ 2ë²ˆë§Œ", "ë³µì•½ì€ ë³µìš©í•  ë•Œë§ˆë‹¤" | EMA ë¹ˆë„ ì„¤ì • |
| `auto_recommend` | "AI ì¶”ì²œëŒ€ë¡œ", "ì•Œì•„ì„œ ì„¤ì •í•´ì¤˜" | ì „ì²´ ì¶”ì²œ ì ìš© |
| `reset` | "ì´ˆê¸°í™”í•´ì¤˜", "ë‹¤ ì§€ì›Œ" | ì „ì²´ ì„ íƒ í•´ì œ |

### Step 4: AI ë„êµ¬

| ì˜ë„ | ì˜ˆì‹œ ë°œí™” | ì•¡ì…˜ |
|------|----------|------|
| `select_tool` | "ì¸ê³¼ ë¶„ì„ ì¶”ê°€", "SHAP ì¨ì¤˜" | ë„êµ¬ ì„ íƒ |
| `explain_tool` | "ì´ê²Œ ë­ì•¼?", "ì™œ ì´ê±° ì¶”ì²œí•´?" | ë„êµ¬ ì„¤ëª… í‘œì‹œ |

### Step 5: ì˜ˆì‚°

| ì˜ë„ | ì˜ˆì‹œ ë°œí™” | ì•¡ì…˜ |
|------|----------|------|
| `set_reward` | "í•˜ë£¨ 500ì›", "ì°¸ì—¬ìë‹¹ 3ë§Œì›" | ë³´ìƒ ê¸ˆì•¡ ì„¤ì • |
| `calculate_total` | "ì´ ë¹„ìš© ì–¼ë§ˆì•¼?", "ì˜ˆì‚° ê³„ì‚°í•´ì¤˜" | ì˜ˆì‚° ê³„ì‚° íŠ¸ë¦¬ê±° |

---

## ë°±ì—”ë“œ API

### 1. AI ì˜ë„ ë¶„ì„ (ë³µì¡í•œ ìš”ì²­)

```
POST /api/v2/ai/parse-intent
Authorization: Bearer {jwt}

Request:
{
  "message": "ë‹¹ë‡¨ í™˜ì ì¤‘ì—ì„œ 40ëŒ€ ì´ìƒ, CGM ë°ì´í„° ìˆëŠ” ì‚¬ëŒë§Œ ëª¨ì§‘í•˜ê³  ì‹¶ì–´",
  "context": {
    "step": 2,
    "current_state": {
      "methodology": "rct",
      "age_min": 30,
      "age_max": 60,
      "conditions": ["diabetes_t2"]
    }
  }
}

Response:
{
  "intents": [
    {
      "type": "set_condition",
      "params": { "id": "diabetes_t2", "action": "select" },
      "confidence": 0.95
    },
    {
      "type": "set_age_range",
      "params": { "min": 40, "max": null },
      "confidence": 0.92
    },
    {
      "type": "set_condition",
      "params": { "id": "cgm_user", "action": "select" },
      "confidence": 0.88
    }
  ],
  "response_text": "ì°¸ì—¬ ì¡°ê±´ì„ ì„¤ì •í–ˆìŠµë‹ˆë‹¤:\n- ì§ˆí™˜: ì œ2í˜• ë‹¹ë‡¨\n- ì—°ë ¹: 40ì„¸ ì´ìƒ\n- í•„ìˆ˜ ë°ì´í„°: CGM",
  "actions_preview": [
    { "field": "ì—°ë ¹", "from": "30-60ì„¸", "to": "40ì„¸ ì´ìƒ" },
    { "field": "ì¡°ê±´", "from": "ë‹¹ë‡¨", "to": "ë‹¹ë‡¨, CGM ì‚¬ìš©ì" }
  ]
}
```

### 2. ì¶”ì²œ ì„¤ì • ì¡°íšŒ

```
POST /api/v2/ai/recommend-settings
Authorization: Bearer {jwt}

Request:
{
  "project_id": "uuid",
  "step": 3,
  "research_question": "ë³µì•½ ìˆœì‘ë„ì™€ í˜ˆë‹¹ ë³€ë™ì˜ ìƒê´€ê´€ê³„"
}

Response:
{
  "recommendations": {
    "data_collection": {
      "passive": ["cgm", "heart_rate", "sleep", "steps"],
      "active": ["medication", "diet", "mood"],
      "qualitative": ["meal_photo"]
    },
    "ema_settings": {
      "diet": "3_per_day",
      "mood": "2_per_day",
      "medication": "per_dose"
    }
  },
  "explanation": "ë³µì•½-í˜ˆë‹¹ ì¸ê³¼ê´€ê³„ ë¶„ì„ì„ ìœ„í•´ CGMê³¼ ë³µì•½ ê¸°ë¡ì´ í•„ìˆ˜ì…ë‹ˆë‹¤. ì‹ë‹¨ ë°ì´í„°ëŠ” í˜ˆë‹¹ ë³€ë™ í•´ì„ì— ë§¥ë½ì„ ì œê³µí•©ë‹ˆë‹¤."
}
```

### 3. ë³€ê²½ ì‚¬í•­ ì ìš© í™•ì¸

```
POST /api/v2/ai/apply-changes
Authorization: Bearer {jwt}

Request:
{
  "project_id": "uuid",
  "changes": [
    { "type": "set_age_range", "params": { "min": 40, "max": 70 } },
    { "type": "select_data", "params": { "id": "cgm" } }
  ]
}

Response:
{
  "applied": true,
  "validation": {
    "zkp_circuits_valid": true,
    "estimated_matches": 1847,
    "warnings": []
  }
}
```

---

## í”„ë¡ íŠ¸ì—”ë“œ êµ¬í˜„

### íŒ¨í„´ ë§¤ì¹­ (ë¡œì»¬)

```javascript
const PATTERNS = {
  // ì—°ë ¹
  age_above: /(\d+)\s*(ì„¸|ì‚´)?\s*(ì´ìƒ|ë¶€í„°)/,
  age_range: /(\d+)\s*(ì„¸|ì‚´)?\s*[-~]\s*(\d+)\s*(ì„¸|ì‚´)?/,
  age_decade: /(\d+)0?\s*ëŒ€/,

  // ì§ˆí™˜
  diabetes: /(ë‹¹ë‡¨|diabetes)/i,
  hypertension: /(ê³ í˜ˆì••|hypertension)/i,

  // ë°ì´í„°
  cgm: /(cgm|ì—°ì†\s*í˜ˆë‹¹|í˜ˆë‹¹\s*ëª¨ë‹ˆí„°)/i,
  heart_rate: /(ì‹¬ë°•|heart\s*rate)/i,
  sleep: /(ìˆ˜ë©´|sleep)/i,
  diet: /(ì‹ë‹¨|ì‹ì‚¬|meal|diet)/i,
  medication: /(ë³µì•½|medication|ì•½)/i,

  // ì•¡ì…˜
  add: /(ì¶”ê°€|ë„£ì–´|í¬í•¨|ì„ íƒ)/,
  remove: /(ì‚­ì œ|ë¹¼|ì œì™¸|í•´ì œ)/,
  recommend: /(ì¶”ì²œ|ê¶Œì¥|ì•Œì•„ì„œ|ìë™)/,
  reset: /(ì´ˆê¸°í™”|ë¦¬ì…‹|clear|ì§€ì›Œ)/
};

function parseLocal(text) {
  const intents = [];

  // ì—°ë ¹ íŒŒì‹±
  let match = text.match(PATTERNS.age_above);
  if (match) {
    intents.push({
      type: 'set_age_range',
      params: { min: parseInt(match[1]), max: 100 }
    });
  }

  // ì§ˆí™˜ íŒŒì‹±
  if (PATTERNS.diabetes.test(text)) {
    const action = PATTERNS.remove.test(text) ? 'deselect' : 'select';
    intents.push({
      type: 'set_condition',
      params: { id: 'diabetes_t2', action }
    });
  }

  // ... ê¸°íƒ€ íŒ¨í„´

  return intents;
}
```

### DOM ì—…ë°ì´íŠ¸

```javascript
function applyIntent(intent) {
  switch (intent.type) {
    case 'set_age_range':
      document.querySelector('[data-field="age_min"]').value = intent.params.min;
      document.querySelector('[data-field="age_max"]').value = intent.params.max || '';
      break;

    case 'set_condition':
      const chip = document.querySelector(`[data-id="${intent.params.id}"]`);
      chip?.classList.toggle('selected', intent.params.action === 'select');
      break;

    case 'select_data':
      const item = document.querySelector(`.data-item[data-id="${intent.params.id}"]`);
      item?.classList.add('selected');
      break;

    // ...
  }

  // ë³€ê²½ ì´ë ¥ ì €ì¥
  changeHistory.push({
    id: Date.now(),
    intent,
    timestamp: new Date()
  });
}
```

---

## ë³€ê²½ ì´ë ¥ (Undo)

```javascript
const changeHistory = [];

function undo(actionId) {
  const index = changeHistory.findIndex(h => h.id === actionId);
  if (index === -1) return;

  const action = changeHistory[index];

  // ì´ì „ ìƒíƒœë¡œ ë³µì›
  switch (action.intent.type) {
    case 'set_age_range':
      document.querySelector('[data-field="age_min"]').value = action.previous.min;
      document.querySelector('[data-field="age_max"]').value = action.previous.max;
      break;
    // ...
  }

  changeHistory.splice(index, 1);
}
```

---

## íŒŒì¼ êµ¬ì¡°

```
wireframes/research/
â”œâ”€â”€ ai-chat-panel.css     # AI ì±„íŒ… íŒ¨ë„ ìŠ¤íƒ€ì¼
â”œâ”€â”€ ai-chat-panel.js      # AI ì±„íŒ… ë¡œì§
â”œâ”€â”€ AI_CHAT_SPEC.md       # ì´ ë¬¸ì„œ
â”œâ”€â”€ create.html           # Step 1: AI ì„¤ê³„
â”œâ”€â”€ create-step2.html     # Step 2: ì„¤ê³„ í™•ì¸ + AI íŒ¨ë„
â”œâ”€â”€ create-step3.html     # Step 3: ë°ì´í„° ìˆ˜ì§‘ + AI íŒ¨ë„
â”œâ”€â”€ create-step4.html     # Step 4: AI ë„êµ¬ + AI íŒ¨ë„
â”œâ”€â”€ create-step5.html     # Step 5: ì˜ˆì‚° + AI íŒ¨ë„
â””â”€â”€ create-step6.html     # Step 6: ì—ìŠ¤í¬ë¡œ + AI íŒ¨ë„
```

---

## ë‹¤ìŒ ë‹¨ê³„

1. Step 4~6ì— AI íŒ¨ë„ ì ìš©
2. ë°±ì—”ë“œ `/ai/parse-intent` API êµ¬í˜„
3. í”„ë¡ íŠ¸ì—”ë“œ NLU íŒ¨í„´ í™•ì¥
4. ì‹¤ì‹œê°„ ZKP ì‹œë®¬ë ˆì´ì…˜ ì—°ë™
5. A/B í…ŒìŠ¤íŠ¸: AI íŒ¨ë„ ìœ ë¬´ ë¹„êµ

---

*Last Updated: 2026-02-01*
