<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>SportiQue Architecture v4</title>
<style>
  * { margin: 0; padding: 0; box-sizing: border-box; }
  body {
    font-family: 'SF Mono', 'Fira Code', 'Consolas', monospace;
    background: #0d1117;
    color: #e6edf3;
    padding: 24px;
    line-height: 1.5;
    overflow-x: hidden;
  }
  h1 { text-align: center; font-size: 20px; margin-bottom: 4px; letter-spacing: 1px; }
  .subtitle { text-align: center; font-size: 11px; color: #8b949e; margin-bottom: 28px; }

  .section-divider { display: flex; align-items: center; gap: 14px; margin: 28px 0 16px; }
  .section-divider::before, .section-divider::after { content: ''; flex: 1; height: 1px; background: #30363d; }
  .section-divider span { font-size: 15px; font-weight: 700; white-space: nowrap; letter-spacing: 1px; }

  .layer { border: 1px solid #30363d; border-radius: 8px; margin-bottom: 14px; overflow: hidden; }
  .layer-header { padding: 8px 16px; font-size: 13px; font-weight: 700; }
  .layer-body { padding: 14px 16px; }

  .input-layer .layer-header { background: #1a3a2a; color: #3fb950; }
  .data-layer .layer-header { background: #1a1a2a; color: #79c0ff; }
  .output-layer .layer-header { background: #1a2a2a; color: #56d4dd; }
  .server-layer .layer-header { background: #161b22; color: #8b949e; }
  .enterprise-layer .layer-header { background: #2a2a1a; color: #e3b341; }

  .cards { display: flex; gap: 10px; flex-wrap: wrap; }
  .input-cards {
    display: grid;
    grid-template-columns: repeat(5, minmax(0, 1fr));
    gap: 10px;
  }
  .input-cards .card { min-width: 0; }
  .card {
    background: #0d1117;
    border: 1px solid #21262d;
    border-radius: 4px;
    padding: 10px;
    flex: 1;
    min-width: 130px;
    font-size: 11px;
  }
  .card-title { font-size: 11px; font-weight: 700; margin-bottom: 4px; display: flex; align-items: center; gap: 5px; }
  .card ul { padding-left: 14px; font-size: 10px; color: #8b949e; }
  .card li { margin-bottom: 2px; }

  .routing-banner {
    background: #161b22;
    border: 1px solid #30363d;
    border-radius: 8px;
    padding: 12px;
    margin-top: 10px;
  }
  .routing-title { font-size: 12px; font-weight: 700; color: #e3b341; margin-bottom: 6px; }
  .routing-pills { display: flex; flex-wrap: wrap; gap: 8px; }
  .pill { padding: 6px 10px; border-radius: 6px; font-size: 10px; }
  .pill-s { background: #2a1a3a; border: 1px solid #bc8cff44; }
  .pill-n { background: #1a2a3a; border: 1px solid #58a6ff44; }
  .pill-ai { background: #3a2a1a; border: 1px solid #d2992244; }

  .pipeline-strip {
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 10px;
    background: #161b22;
    border: 1px solid #30363d;
    border-radius: 8px;
    padding: 10px 12px;
    margin-bottom: 12px;
  }
  .pipe-node {
    background: #0d1117;
    border: 1px solid #30363d;
    border-radius: 6px;
    padding: 6px 10px;
    font-size: 10px;
    color: #c9d1d9;
    font-weight: 700;
  }
  .pipe-arrow {
    font-size: 16px;
    color: #79c0ff;
    line-height: 1;
    font-weight: 700;
  }

  .flow-arrow {
    display: flex;
    justify-content: center;
    margin: -2px 0 10px 0;
  }
  .flow-arrow span {
    display: inline-flex;
    align-items: center;
    gap: 8px;
    background: #161b22;
    border: 1px solid #30363d;
    border-radius: 999px;
    padding: 5px 12px;
    font-size: 10px;
    color: #8b949e;
  }

  .node-connectors {
    display: grid;
    grid-template-columns: repeat(5, minmax(0, 1fr));
    gap: 10px;
    margin: 4px 0 10px 0;
    padding: 0 4px;
  }
  .node-connectors span {
    position: relative;
    display: block;
    height: 38px;
  }
  .node-connectors span::before {
    content: '';
    position: absolute;
    left: 50%;
    transform: translateX(-50%);
    top: 0;
    width: 2px;
    height: 28px;
    background: linear-gradient(180deg, #bc8cff, #79c0ff);
    border-radius: 2px;
  }
  .node-connectors span::after {
    content: '';
    position: absolute;
    left: 50%;
    transform: translateX(-50%);
    top: 26px;
    width: 0;
    height: 0;
    border-left: 6px solid transparent;
    border-right: 6px solid transparent;
    border-top: 10px solid #bc8cff;
  }

  .server-mini-grid { display: grid; grid-template-columns: repeat(3, minmax(0, 1fr)); gap: 10px; }
  .mini-box { background: #0d1117; border: 1px solid #21262d; border-radius: 6px; padding: 10px; }
  .mini-box h4 { font-size: 11px; margin-bottom: 5px; }
  .mini-box ul { padding-left: 14px; font-size: 10px; color: #8b949e; }

  .db-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 12px; }
  .db-box { background: #161b22; border: 1px solid #30363d; border-radius: 6px; padding: 10px; }
  .db-box h4 { font-size: 11px; margin-bottom: 5px; }
  .db-box ul { padding-left: 14px; font-size: 10px; color: #8b949e; }

  .flow-focus { background: #161b22; border: 1px solid #30363d; border-radius: 8px; padding: 12px; margin-bottom: 12px; }
  .flow-focus h3 { font-size: 12px; color: #79c0ff; margin-bottom: 8px; }
  .flow-focus-grid { display: grid; grid-template-columns: repeat(5, minmax(0, 1fr)); gap: 8px; }
  .flow-focus-node { background: #0d1117; border: 1px solid #21262d; border-radius: 6px; padding: 8px; font-size: 10px; color: #8b949e; }
  .route-split { display: grid; gap: 6px; margin-top: 6px; }
  .route-mini {
    border: 1px solid #30363d;
    border-radius: 5px;
    padding: 6px;
    background: #10151d;
    font-size: 9px;
    line-height: 1.45;
  }
  .pill, .flow-focus-node, .route-mini, .subflow-text, .step-desc {
    overflow-wrap: anywhere;
    word-break: break-word;
  }
  .route-mini-s { border-color: #bc8cff55; }
  .route-mini-n { border-color: #58a6ff55; }
  .route-mini-ai { border-color: #d2992255; }
  .output-rule-grid { display: grid; grid-template-columns: repeat(2, minmax(0, 1fr)); gap: 8px; margin-top: 8px; }
  .output-rule-node {
    background: #0d1117;
    border: 1px solid #21262d;
    border-radius: 6px;
    padding: 8px;
    font-size: 9px;
    color: #8b949e;
    line-height: 1.5;
  }
  .output-rule-node strong { color: #79c0ff; }

  .role-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 12px; }
  .role-card { background: #0d1117; border: 1px solid #21262d; border-radius: 6px; padding: 12px; }
  .role-card h4 { font-size: 12px; margin-bottom: 6px; }
  .role-row { display: flex; justify-content: space-between; font-size: 10px; padding: 2px 0; border-bottom: 1px solid #21262d; }
  .role-name { color: #79c0ff; font-weight: 600; }
  .role-desc { color: #8b949e; }

  .flows-grid { display: grid; grid-template-columns: repeat(4, minmax(0, 1fr)); gap: 12px; align-items: start; }
  .flow-panel { border-radius: 8px; overflow: hidden; }
  .flow-header { padding: 10px 12px; font-size: 11px; font-weight: 700; text-align: center; }
  .flow-body { padding: 10px; background: #0d1117; }

  .fp-nonsensitive { border: 2px solid #58a6ff44; }
  .fp-nonsensitive .flow-header { background: #1a2a3a; color: #58a6ff; }
  .fp-sensitive { border: 2px solid #bc8cff44; }
  .fp-sensitive .flow-header { background: #2a1a3a; color: #bc8cff; }
  .fp-ai { border: 2px solid #d2992244; }
  .fp-ai .flow-header { background: #3a2a1a; color: #d29922; }
  .fp-audit { border: 2px solid #3fb95044; }
  .fp-audit .flow-header { background: #1a3a2a; color: #3fb950; }

  .step { background: #161b22; border: 1px solid #30363d; border-radius: 5px; padding: 8px; margin-bottom: 4px; }
  .step-num { font-size: 9px; font-weight: 800; margin-bottom: 2px; }
  .step-title { font-size: 10px; font-weight: 700; margin-bottom: 2px; }
  .step-desc { font-size: 9px; color: #8b949e; }
  .step-code {
    font-size: 8px;
    color: #79c0ff;
    background: #0d1117;
    padding: 2px 5px;
    border-radius: 3px;
    margin-top: 3px;
    display: inline-block;
    word-break: break-word;
  }
  .step-arrow { text-align: center; padding: 1px 0; font-size: 11px; color: #484f58; }

  .subflow-box { border: 1px dashed #30363d; border-radius: 6px; padding: 6px; margin-top: 6px; background: #10151d; }
  .subflow-title { font-size: 9px; font-weight: 700; margin-bottom: 2px; color: #bc8cff; }
  .subflow-text { font-size: 9px; color: #8b949e; }
  .subflow-branch { text-align: center; font-size: 9px; color: #79c0ff; margin: 5px 0 2px; }
  .subflow-merge {
    margin-top: 6px;
    text-align: center;
    font-size: 9px;
    color: #79c0ff;
    border: 1px dashed #30363d;
    border-radius: 6px;
    padding: 5px 6px;
    background: #10151d;
  }

  .warn-box { background: #161b22; border-left: 3px solid #f85149; padding: 8px 10px; font-size: 9px; color: #8b949e; border-radius: 0 4px 4px 0; margin-top: 7px; }
  .warn-box strong { color: #f85149; }
  .info-box { background: #161b22; border-left: 3px solid #58a6ff; padding: 8px 10px; font-size: 9px; color: #8b949e; border-radius: 0 4px 4px 0; margin-top: 7px; }
  .info-box strong { color: #58a6ff; }
  .success-box { background: #161b22; border-left: 3px solid #3fb950; padding: 8px 10px; font-size: 9px; color: #8b949e; border-radius: 0 4px 4px 0; margin-top: 7px; }
  .success-box strong { color: #3fb950; }

  .t { width: 100%; font-size: 9px; border-collapse: collapse; background: #161b22; border-radius: 6px; overflow: hidden; }
  .t th { padding: 5px 8px; text-align: left; border-bottom: 1px solid #30363d; color: #8b949e; font-weight: 600; font-size: 8px; }
  .t td { padding: 4px 8px; border-bottom: 1px solid #21262d; word-break: break-word; }
  .t tr:last-child td { border: none; }
  .input-guide { margin-bottom: 10px; }
  .feature-table { margin-top: 6px; font-size: 8px; }
  .feature-table th { font-size: 8px; padding: 4px 5px; }
  .feature-table td { font-size: 8px; padding: 4px 5px; }

  .ent-flow-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 12px; align-items: start; }

  .summary-table { width: 100%; font-size: 10px; border-collapse: collapse; }
  .summary-table th { padding: 5px 10px; text-align: left; border-bottom: 1px solid #30363d; color: #8b949e; font-weight: 600; font-size: 9px; background: #161b22; }
  .summary-table td { padding: 4px 10px; border-bottom: 1px solid #21262d; }

  .tag-s { color: #bc8cff; font-weight: 600; }
  .tag-n { color: #58a6ff; font-weight: 600; }
  .tag-ai { color: #d29922; font-weight: 600; }
  .tag-e { color: #e3b341; font-weight: 600; }

  .legend { margin-top: 14px; padding: 10px 14px; background: #161b22; border: 1px solid #30363d; border-radius: 6px; font-size: 10px; color: #8b949e; display: flex; gap: 16px; flex-wrap: wrap; }

  @media (max-width: 1024px) {
    body { padding: 14px; }
    .pipeline-strip { flex-direction: column; }
    .pipe-arrow { transform: rotate(90deg); }
    .flows-grid { grid-template-columns: 1fr; }
    .input-cards { grid-template-columns: 1fr; }
    .flow-focus-grid { grid-template-columns: 1fr; }
    .output-rule-grid { grid-template-columns: 1fr; }
    .node-connectors { grid-template-columns: 1fr; }
    .db-grid { grid-template-columns: 1fr; }
    .server-mini-grid { grid-template-columns: 1fr; }
    .role-grid { grid-template-columns: 1fr; }
    .ent-flow-grid { grid-template-columns: 1fr; }
    .summary-table th, .summary-table td { font-size: 9px; }
  }
</style>
</head>
<body>

<h1>SportiQue í†µí•© ì•„í‚¤í…ì²˜ v4</h1>
<p class="subtitle">í”Œë¡œìš° ì¤‘ì‹¬ êµ¬ì¡° + ì…ë ¥/ì¶œë ¥ ë¶„ë¦¬ + ë¬´ê°€ë¡œìŠ¤í¬ë¡¤ Â· 2026-02-08</p>

<!-- PART 1 -->
<div class="section-divider"><span style="color:#79c0ff;">PART 1 â€” DB ì…ë ¥ (Write Path)</span></div>

<div class="pipeline-strip">
  <div class="pipe-node">ğŸ“¥ ì…ë ¥ë‹¨</div>
  <div class="pipe-arrow">â†’</div>
  <div class="pipe-node">ğŸ—„ï¸ UniQdata DB</div>
</div>

<div class="layer input-layer">
  <div class="layer-header">ğŸ“¥ ì…ë ¥ë‹¨ (Data Ingestion)</div>
  <div class="layer-body">
    <div class="input-cards">
      <div class="card">
        <div class="card-title">ğŸ“± Medi Q ì•± ì…ë ¥</div>
        <table class="t feature-table">
          <tr><th>ê¸°ëŠ¥</th><th>ë¯¼ê°ë„</th><th>ì„œë²„</th><th>ì €ì¥</th></tr>
          <tr><td>ë¬¸ì§„/ì¦ìƒ ì›ë¬¸ ì œì¶œ</td><td class="tag-s">ë¯¼ê°</td><td>ë¸”ë¡ì²´ì¸</td><td>agreements í™•ì¸ â†’ data_points(source=mediq) + anchor_logs</td></tr>
          <tr><td>PRO ê°œì¸ ì‘ë‹µ ì œì¶œ</td><td class="tag-s">ë¯¼ê°</td><td>ë¸”ë¡ì²´ì¸</td><td>data_points(value ì›ë¬¸, source=mediq) + anchor_logs</td></tr>
          <tr><td>ì„¤ë¬¸ ì§‘ê³„ í†µê³„ ì¡°íšŒìš© ì…ë ¥</td><td class="tag-n">ë¹„ë¯¼ê°</td><td>ë°±ì—”ë“œ</td><td>data_points(value ë¹„ì‹ë³„, source=mediq)</td></tr>
          <tr><td>ì•± ì´ë²¤íŠ¸/í´ë¦­ ë¡œê·¸</td><td class="tag-n">ë¹„ë¯¼ê°</td><td>ë°±ì—”ë“œ</td><td>data_points(value ë¹„ì‹ë³„ ì´ë²¤íŠ¸, source=mediq)</td></tr>
        </table>
      </div>
      <div class="card">
        <div class="card-title">ğŸ ë³´ë‹µ ì•± ì…ë ¥</div>
        <table class="t feature-table">
          <tr><th>ê¸°ëŠ¥</th><th>ë¯¼ê°ë„</th><th>ì„œë²„</th><th>ì €ì¥</th></tr>
          <tr><td>í–‰ë™ ì¸ì¦ ì›ë¬¸ ì œì¶œ</td><td class="tag-s">ë¯¼ê°</td><td>ë¸”ë¡ì²´ì¸</td><td>agreements í™•ì¸ â†’ data_points(source=bodap) + anchor_logs</td></tr>
          <tr><td>ê°œì¸ ë¦¬ì›Œë“œ ì •ì‚° ê·¼ê±° ì œì¶œ</td><td class="tag-s">ë¯¼ê°</td><td>ë¸”ë¡ì²´ì¸</td><td>settlements + data_points(source=bodap) + anchor_logs</td></tr>
          <tr><td>ìº í˜ì¸ ë°˜ì‘ë¥  ì§‘ê³„ ì…ë ¥</td><td class="tag-n">ë¹„ë¯¼ê°</td><td>ë°±ì—”ë“œ</td><td>data_points(value ë¹„ì‹ë³„, source=bodap)</td></tr>
          <tr><td>ë¦¬ì›Œë“œ í˜„í™© ëŒ€ì‹œë³´ë“œìš© ì§‘ê³„</td><td class="tag-n">ë¹„ë¯¼ê°</td><td>ë°±ì—”ë“œ</td><td>data_points(value ë¹„ì‹ë³„ ì§‘ê³„, source=bodap)</td></tr>
        </table>
      </div>
      <div class="card">
        <div class="card-title">âŒš UniQdata ì•± ì…ë ¥</div>
        <table class="t feature-table">
          <tr><th>ê¸°ëŠ¥</th><th>ë¯¼ê°ë„</th><th>ì„œë²„</th><th>ì €ì¥</th></tr>
          <tr><td>ì‹¤ì‹œê°„ ë°”ì´íƒˆ ì›ë¬¸ ì—…ë¡œë“œ</td><td class="tag-s">ë¯¼ê°</td><td>ë¸”ë¡ì²´ì¸</td><td>agreements í™•ì¸ â†’ data_points(source=uniqdata_app) + anchor_logs</td></tr>
          <tr><td>ë³µì•½/ì¦ìƒ ê°œì¸ ê¸°ë¡</td><td class="tag-s">ë¯¼ê°</td><td>ë¸”ë¡ì²´ì¸</td><td>data_points(value ì›ë¬¸, source=uniqdata_app) + anchor_logs</td></tr>
          <tr><td>ì¼/ì£¼ ë‹¨ìœ„ ê±´ê°• ìš”ì•½ ì§€í‘œ</td><td class="tag-n">ë¹„ë¯¼ê°</td><td>ë°±ì—”ë“œ</td><td>data_points(value ë¹„ì‹ë³„ ìš”ì•½, source=uniqdata_app)</td></tr>
          <tr><td>ë””ë°”ì´ìŠ¤ ìƒíƒœ/ìˆ˜ì§‘ í’ˆì§ˆ ë¡œê·¸</td><td class="tag-n">ë¹„ë¯¼ê°</td><td>ë°±ì—”ë“œ</td><td>data_points(value ë¹„ì‹ë³„ ìš´ì˜ì§€í‘œ, source=uniqdata_app)</td></tr>
        </table>
      </div>
      <div class="card">
        <div class="card-title">ğŸ–¥ï¸ UniQdata ì›¹Â·ê¸°ê´€ ì—…ë¡œë“œ</div>
        <table class="t feature-table">
          <tr><th>ê¸°ëŠ¥</th><th>ë¯¼ê°ë„</th><th>ì„œë²„</th><th>ì €ì¥</th></tr>
          <tr><td>í™˜ì ë‹¨ìœ„ CSV ì›ë¬¸ ì—…ë¡œë“œ</td><td class="tag-s">ë¯¼ê°</td><td>ë¸”ë¡ì²´ì¸</td><td>agreements + data_points(source=enterprise_web_upload) + anchor_logs</td></tr>
          <tr><td>ê¸°ê´€ EMR/IoT ìƒì„¸ ì—…ë¡œë“œ</td><td class="tag-s">ë¯¼ê°</td><td>ë¸”ë¡ì²´ì¸</td><td>agreements + data_points(source=institution_upload) + anchor_logs</td></tr>
          <tr><td>ìµëª… ì—°êµ¬ë°ì´í„°ì…‹ ì—…ë¡œë“œ</td><td class="tag-n">ë¹„ë¯¼ê°</td><td>ë°±ì—”ë“œ</td><td>data_points(value ë¹„ì‹ë³„, source=enterprise_web_upload)</td></tr>
          <tr><td>í†µê³„ ë¦¬í¬íŠ¸/ë©”íƒ€ ì—…ë¡œë“œ</td><td class="tag-n">ë¹„ë¯¼ê°</td><td>ë°±ì—”ë“œ</td><td>research_projects ë©”íƒ€ + ë¹„ì‹ë³„ data_points</td></tr>
        </table>
        <div class="spec-info">
          <div class="features">Flow2-3 í•©ì„± ì¤€ë¹„: ownerId/projectId/dataType/time_window í‚¤ë¥¼ ì—…ë¡œë“œ ì‹œì ì— ì •ê·œí™” ì €ì¥</div>
        </div>
      </div>
      <div class="card">
        <div class="card-title">ğŸ¤– AI ë°ì´í„° ì…ë ¥Â·ê²°ê³¼</div>
        <table class="t feature-table">
          <tr><th>ê¸°ëŠ¥</th><th>ë¯¼ê°ë„</th><th>ì„œë²„</th><th>ì €ì¥</th></tr>
          <tr><td>í™˜ì ë‹¨ìœ„ ì˜ˆì¸¡ ìš”ì²­</td><td class="tag-s">ë¯¼ê°</td><td>ë¸”ë¡ì²´ì¸â†’AI</td><td>agreements.scope í•„í„° í›„ ì „ë‹¬ + anchor_logs.metadata</td></tr>
          <tr><td>í”„ë¡œì íŠ¸ ì§‘ê³„ ë¶„ì„ ìš”ì²­</td><td class="tag-n">ë¹„ë¯¼ê°</td><td>ë°±ì—”ë“œâ†’AI</td><td>ë¹„ì‹ë³„ ì§‘ê³„ data_points ì „ë‹¬ + ìš”ì²­ ë¡œê·¸</td></tr>
          <tr><td>ê°œì¸ ë¦¬ìŠ¤í¬ ê²°ê³¼ ì €ì¥</td><td class="tag-s">ë¯¼ê°</td><td>ë¸”ë¡ì²´ì¸</td><td>anchor_logs(metadata, txHash) + ì ‘ê·¼ ì¦ì </td></tr>
          <tr><td>ì§‘ê³„ ë¦¬í¬íŠ¸/ìŠ¤ì½”ì–´ ì €ì¥</td><td class="tag-n">ë¹„ë¯¼ê°</td><td>ë°±ì—”ë“œ</td><td>ë¹„ì‹ë³„ ê²°ê³¼ ë°ì´í„° + í”„ë¡œì íŠ¸ ë©”íƒ€</td></tr>
        </table>
      </div>
    </div>
  </div>
</div>

<div class="node-connectors" aria-hidden="true">
  <span></span>
  <span></span>
  <span></span>
  <span></span>
  <span></span>
</div>

<div class="flow-focus">
  <h3>ì…ë ¥ ì €ì¥ ê²½ë¡œ (ì…ë ¥ë‹¨ â†’ DB)</h3>
  <div class="flow-focus-grid">
    <div class="flow-focus-node">
      <strong style="color:#79c0ff;">Medi Q ê²½ë¡œ ë…¸ë“œ</strong>
      <div class="route-split">
        <div class="route-mini route-mini-s">
          <strong style="color:#bc8cff;">ë¯¼ê°</strong> â†’ ë¸”ë¡ì²´ì¸ ì„œë²„
          <br>â†’ ownerId í™•ì¸ + agreements(status=active, ê¸°ê°„ ìœ íš¨) ê²€ì‚¬
          <br>â†’ data_points(source=mediq) + anchor_logs(data_submit/data_access)
        </div>
        <div class="route-mini route-mini-n">
          <strong style="color:#58a6ff;">ë¹„ë¯¼ê°</strong> â†’ ë°±ì—”ë“œ ì„œë²„
          <br>â†’ ìŠ¤í‚¤ë§ˆ ê²€ì¦/PII ì œê±°
          <br>â†’ data_points(value ë¹„ì‹ë³„, source=mediq) ì €ì¥/ì¡°íšŒ
        </div>
      </div>
    </div>
    <div class="flow-focus-node">
      <strong style="color:#79c0ff;">ë³´ë‹µ ê²½ë¡œ ë…¸ë“œ</strong>
      <div class="route-split">
        <div class="route-mini route-mini-s">
          <strong style="color:#bc8cff;">ë¯¼ê°</strong> â†’ ë¸”ë¡ì²´ì¸ ì„œë²„
          <br>â†’ ownerId í™•ì¸ + agreements(status=active, ê¸°ê°„ ìœ íš¨) ê²€ì‚¬
          <br>â†’ data_points(source=bodap) + anchor_logs(data_submit/data_access)
        </div>
        <div class="route-mini route-mini-n">
          <strong style="color:#58a6ff;">ë¹„ë¯¼ê°</strong> â†’ ë°±ì—”ë“œ ì„œë²„
          <br>â†’ ìŠ¤í‚¤ë§ˆ ê²€ì¦/PII ì œê±°
          <br>â†’ data_points(value ë¹„ì‹ë³„, source=bodap) ì €ì¥/ì¡°íšŒ
        </div>
      </div>
    </div>
    <div class="flow-focus-node">
      <strong style="color:#79c0ff;">UniQdata ì•± ê²½ë¡œ ë…¸ë“œ</strong>
      <div class="route-split">
        <div class="route-mini route-mini-s">
          <strong style="color:#bc8cff;">ë¯¼ê°</strong> â†’ ë¸”ë¡ì²´ì¸ ì„œë²„
          <br>â†’ ownerId í™•ì¸ + agreements(status=active, ê¸°ê°„ ìœ íš¨) ê²€ì‚¬
          <br>â†’ data_points(source=uniqdata_app) + anchor_logs(data_submit/data_access)
        </div>
        <div class="route-mini route-mini-n">
          <strong style="color:#58a6ff;">ë¹„ë¯¼ê°</strong> â†’ ë°±ì—”ë“œ ì„œë²„
          <br>â†’ ìŠ¤í‚¤ë§ˆ ê²€ì¦/PII ì œê±°
          <br>â†’ data_points(value ë¹„ì‹ë³„, source=uniqdata_app) ì €ì¥/ì¡°íšŒ
        </div>
      </div>
    </div>
    <div class="flow-focus-node">
      <strong style="color:#79c0ff;">ì›¹Â·ê¸°ê´€ ì—…ë¡œë“œ ê²½ë¡œ ë…¸ë“œ</strong>
      <div class="route-split">
        <div class="route-mini route-mini-s">
          <strong style="color:#bc8cff;">ë¯¼ê°</strong> â†’ ë¸”ë¡ì²´ì¸ ì„œë²„
          <br>â†’ ownerId/projectId ê¸°ì¤€ agreements ê²€ì‚¬
          <br>â†’ data_points(source={enterprise_web_upload|institution_upload}) + anchor_logs
        </div>
        <div class="route-mini route-mini-n">
          <strong style="color:#58a6ff;">ë¹„ë¯¼ê°</strong> â†’ ë°±ì—”ë“œ ì„œë²„
          <br>â†’ ìŠ¤í‚¤ë§ˆ ê²€ì¦/PII ì œê±°
          <br>â†’ data_points(value ë¹„ì‹ë³„, source={enterprise_web_upload|institution_upload})
        </div>
        <div class="route-mini route-mini-ai">
          <strong style="color:#79c0ff;">Flow2-3 ì„œë²„ì¸¡ í•©ì„± ê·œì¹™</strong>
          <br>1) Flow2-1 í™˜ì data_points(ownerId, source=uniqdata_app) ì¡°íšŒ
          <br>2) Flow2-2 ì›¹/ê¸°ê´€ data_points(projectId, source={enterprise_web_upload|institution_upload}) ì¡°íšŒ
          <br>3) dataType ë§¤í•‘ + time_window ì •ë ¬ë¡œ ë ˆì½”ë“œ ì •í•©ì„± ë§ì¶¤
          <br>4) agreements.dataScopes ë²”ìœ„ ë°– ì»¬ëŸ¼ì€ ë§ˆìŠ¤í‚¹/ì œì™¸
          <br>5) ë‹¨ì¼ composite payload ë°˜í™˜ + anchor_logs(anchorType=data_access) ê¸°ë¡
        </div>
      </div>
    </div>
    <div class="flow-focus-node">
      <strong style="color:#79c0ff;">AI ê²½ë¡œ ë…¸ë“œ</strong>
      <div class="route-split">
        <div class="route-mini route-mini-s">
          <strong style="color:#bc8cff;">ë¯¼ê° ì…ë ¥</strong> â†’ ë¸”ë¡ì²´ì¸ ë™ì˜/ê¶Œí•œ ê²€ì¦
          <br>â†’ agreements.dataScopes ê¸°ì¤€ ìµœì†Œ ì»¬ëŸ¼ í•„í„°ë§
          <br>â†’ í•„í„°ëœ data_pointsë§Œ AI ì„œë²„ ì „ë‹¬
        </div>
        <div class="route-mini route-mini-n">
          <strong style="color:#58a6ff;">ë¹„ë¯¼ê° ì…ë ¥</strong> â†’ ë°±ì—”ë“œ ì§‘ê³„/ë¹„ì‹ë³„
          <br>â†’ ì§‘ê³„ data_points ì „ë‹¬
          <br>â†’ AI ì…ë ¥ ì´ë²¤íŠ¸ëŠ” anchor_logs.metadataë¡œ ì¶”ì 
        </div>
        <div class="route-mini route-mini-ai">
          <strong style="color:#d29922;">ê²°ê³¼ ì €ì¥/ê°ì‚¬</strong> â†’ ì›ë³¸ ë®ì–´ì“°ê¸° ì—†ìŒ
          <br>â†’ ë¶„ì„ ì¦ì /í•´ì‹œëŠ” anchor_logs(metadata, txHash)ì— ê¸°ë¡
        </div>
      </div>
    </div>
  </div>
  <div class="info-box"><strong>ì €ì¥ ë¬´ê²°ì„±:</strong> ì…ë ¥ë‹¨ì—ì„œ í™•ì •ëœ ë§¤í•‘í‚¤/ìŠ¤í‚¤ë§ˆ ê¸°ì¤€ìœ¼ë¡œ ê²€ì¦ëœ ë ˆì½”ë“œë§Œ DBì— ë°˜ì˜</div>
</div>

<div class="node-connectors" aria-hidden="true">
  <span></span>
  <span></span>
  <span></span>
  <span></span>
  <span></span>
</div>

<div class="layer data-layer">
  <div class="layer-header">ğŸ—„ï¸ UniQdata DB ë°ì´í„° ë ˆì´ì–´ (ì¤‘ì•™)</div>
  <div class="layer-body">
    <div class="db-grid">
      <div class="db-box">
        <h4 style="color:#bc8cff;">ğŸŸ£ Patient Sensitive Layer (blockchain_role)</h4>
        <ul>
          <li><span class="tag-s">[ë¯¼ê°]</span> data_points: í™˜ì ì›ë¬¸/ì‹œê³„ì—´/ì‹ë³„ ê°€ëŠ¥ ê°’</li>
          <li><span class="tag-s">[ë¯¼ê°]</span> agreements: ë™ì˜ ë²”ìœ„/ê¸°ê°„/ì„œëª…/anchorTx</li>
          <li><span class="tag-s">[ë¯¼ê°]</span> settlements: ë³´ìƒ ì •ì‚° ê¸ˆì•¡/ì§€ê¸‰ ë‚´ì—­</li>
          <li><span class="tag-s">[ë¯¼ê°]</span> anchor_logs: ì ‘ê·¼/ì œì¶œ ì¦ì  í•´ì‹œ/tx ë¡œê·¸</li>
        </ul>
      </div>
      <div class="db-box">
        <h4 style="color:#e3b341;">ğŸŸ¡ Enterprise/Team Layer</h4>
        <ul>
          <li><span class="tag-n">[ë¹„ë¯¼ê°]</span> research_projects: í”„ë¡œì íŠ¸ ë©”íƒ€/ë²”ìœ„</li>
          <li><span class="tag-e">[ë‚´ë¶€ë¯¼ê°]</span> team_members: ì—­í• /ì ‘ê·¼ ê¶Œí•œ</li>
          <li><span class="tag-n">[ë¹„ë¯¼ê°]</span> data_collection_configs: ìˆ˜ì§‘ ìŠ¤í‚¤ë§ˆ ì •ì˜</li>
          <li><span class="tag-e">[ë‚´ë¶€ë¯¼ê°]</span> participation_criteria: ì°¸ì—¬ ì¡°ê±´(ì—°êµ¬ ê¸°ì¤€)</li>
          <li><span class="tag-s">[ë¯¼ê°]</span> project_wallets + escrows: ì˜ˆì‚°/ì •ì‚° ë³´ì•ˆ</li>
        </ul>
      </div>
    </div>
    <div class="info-box"><strong>ë¶„ë¥˜ ê¸°ì¤€:</strong> [ë¯¼ê°]=ê°œì¸/ì •ì‚°/ì¦ì  ë°ì´í„°, [ë¹„ë¯¼ê°]=ì¼ë°˜ ë©”íƒ€, [ë‚´ë¶€ë¯¼ê°]=ìš´ì˜ ê¶Œí•œ/ì •ì±… ë°ì´í„°</div>
  </div>
</div>

<div class="flow-arrow"><span>â†“ ì €ì¥ëœ ë°ì´í„°ê°€ ì¡°íšŒ/ë¶„ì„ í”Œë¡œìš°ë¡œ ì „ë‹¬ë¨</span></div>

<!-- PART 2 -->
<div class="section-divider"><span style="color:#79c0ff;">PART 2 â€” DB ì¡°íšŒ/í™œìš© (Read Path)</span></div>

<div class="routing-banner">
  <div class="routing-title">API ì¸í„°í˜ì´ìŠ¤ ê³ ì • (ë¬¸ì„œ ê¸°ì¤€)</div>
  <div class="routing-pills">
    <div class="pill pill-s">GET /blockchain/data/patient/*?ownerId={ownerId}&source=uniqdata_app (Flow2-1)</div>
    <div class="pill pill-s">GET /blockchain/data/enterprise/*?projectId={projectId}&source={enterprise_web_upload|institution_upload} (Flow2-2)</div>
    <div class="pill pill-s">POST /blockchain/data/composite/query { ownerId, projectId, source[] } (Flow2-3: 2-1 + 2-2)</div>
    <div class="pill pill-ai">POST /blockchain/ai/analyze (Flow3)</div>
    <div class="pill pill-s">GET /blockchain/my-data/access-log?ownerId={ownerId} (Flow4)</div>
  </div>
</div>

<div class="info-box"><strong>ì¡°íšŒ ê¸°ì¤€ í‚¤:</strong> Passkey `credentialId` ì¸ì¦ â†’ `accounts.ownerId` ë§¤í•‘ â†’ `ownerId`ë¡œ `data_points/agreements/anchor_logs` ì¡°íšŒ, íŒ€ ë°ì´í„°ëŠ” `projectId`ë¥¼ ì¶”ê°€ ì¡°ê±´ìœ¼ë¡œ ê²°í•©</div>

<div class="flow-focus">
  <h3>ì¶œë ¥ ë¼ìš°íŒ… ì˜ì‚¬ê²°ì • (ê¸°ëŠ¥ ê¸°ì¤€)</h3>
  <div class="output-rule-grid">
    <div class="output-rule-node">
      <strong>FLOW 1 / ë¹„ë¯¼ê° í™”ë©´ (ë°±ì—”ë“œ ì§ì¡°íšŒ)</strong><br>
      ê¸°ëŠ¥: í”„ë¡œì íŠ¸ ëŒ€ì‹œë³´ë“œ, í”„ë¡œì íŠ¸ ëª©ë¡/ìƒíƒœ ì¹´ë“œ, ì—°êµ¬ ì„¤ì • ìš”ì•½<br>
      ê°€ì ¸ì˜¬ ë°ì´í„°: research_projects(title,status,durationDays,targetParticipants), data_collection_configs(passiveData/activeData/collectionFrequency), team_members(ì¸ì›ìˆ˜ ì§‘ê³„)<br>
      íŒë‹¨ ê¸°ì¤€: owner ë‹¨ìœ„ ì›ë¬¸ value ë¯¸í¬í•¨ì´ë©´ ë¹„ë¯¼ê°ìœ¼ë¡œ ë¶„ë¥˜, ë°±ì—”ë“œì—ì„œ ë°”ë¡œ ì¡°íšŒí•´ ì›¹/ì•± ë Œë”ë§
    </div>
    <div class="output-rule-node">
      <strong>FLOW 2 / ë¯¼ê° í™”ë©´ (ë¸”ë¡ì²´ì¸ ê²½ìœ )</strong><br>
      ê¸°ëŠ¥: í™˜ì ìƒì„¸ íƒ€ì„ë¼ì¸, í™˜ì-ì—”í„°í”„ë¼ì´ì¦ˆ í•©ì„± ë¦¬ì„œì¹˜ ë·°<br>
      ê°€ì ¸ì˜¬ ë°ì´í„°: data_points(value ì›ë¬¸, recordedAt, dataType), agreements(dataScopes,startDate,endDate), anchor_logs(tx ì¦ì )<br>
      íŒë‹¨ ê¸°ì¤€: ownerId ê¸°ì¤€ ì›ë¬¸/ë™ì˜ ë²”ìœ„ í¬í•¨ì´ë©´ ë¯¼ê°ìœ¼ë¡œ ë¶„ë¥˜, ë¸”ë¡ì²´ì¸ ì„œë²„ë¥¼ ë°˜ë“œì‹œ ê²½ìœ 
    </div>
    <div class="output-rule-node">
      <strong>FLOW 3 / AI ë¶„ì„ í™”ë©´ (ë¸”ë¡ì²´ì¸ ê²€ì¦ í›„ AI)</strong><br>
      ê¸°ëŠ¥: ë¶„ì„ ìš”ì²­, ëª¨ë¸ ê²°ê³¼ ìš”ì•½/ì ìˆ˜ í‘œì‹œ<br>
      ê°€ì ¸ì˜¬ ë°ì´í„°: agreements.dataScopes ê¸°ì¤€ìœ¼ë¡œ í•„í„°ëœ data_points + anchor_logs.metadata(ê²°ê³¼ ì¦ì )<br>
      íŒë‹¨ ê¸°ì¤€: ë¯¼ê° ì…ë ¥ì€ ë¸”ë¡ì²´ì¸ì—ì„œ í•„í„°ë§ í›„ AI ì „ë‹¬, AI ì„œë²„ëŠ” DB direct access ì—†ìŒ
    </div>
    <div class="output-rule-node">
      <strong>FLOW 4 / ê°ì‚¬ í™”ë©´ (ë³¸ì¸ ë¡œê·¸ ì „ìš©)</strong><br>
      ê¸°ëŠ¥: ë‚´ ë°ì´í„° ì ‘ê·¼ ì´ë ¥ í™”ë©´<br>
      ê°€ì ¸ì˜¬ ë°ì´í„°: anchor_logs(anchorType=data_access), agreements.anchorTx, metadata(ëˆ„ê°€/ì–¸ì œ/ë²”ìœ„)<br>
      íŒë‹¨ ê¸°ì¤€: ownerId ê³ ì • + ë³¸ì¸ ê²€ì¦ í›„ ì¡°íšŒ, íƒ€ì¸ ë¡œê·¸ ì¡°íšŒ ì°¨ë‹¨
    </div>
  </div>
</div>

<div class="flows-grid">

  <div class="flow-panel fp-nonsensitive">
    <div class="flow-header">ğŸ”µ FLOW 1 â€” ë¹„ë¯¼ê° ë°ì´í„° ì¡°íšŒ</div>
    <div class="flow-body">
      <div class="step"><div class="step-num" style="color:#58a6ff;">1</div><div class="step-title" style="color:#58a6ff;">í´ë¼ì´ì–¸íŠ¸ ìš”ì²­</div><div class="step-desc">ì„¸ì…˜ í† í° ê¸°ë°˜ ì¡°íšŒ</div><div class="step-code">GET /api/projects/:id/overview</div></div>
      <div class="step-arrow">â–¼</div>
      <div class="step"><div class="step-num" style="color:#58a6ff;">2</div><div class="step-title" style="color:#58a6ff;">ë°±ì—”ë“œ ê²€ì¦ + ì¡°íšŒ</div><div class="step-desc">projectId/team role í™•ì¸ í›„ research_projects + data_collection_configs + team_members(ì§‘ê³„) ì¡°íšŒ</div></div>
      <div class="step-arrow">â–¼</div>
      <div class="step"><div class="step-num" style="color:#58a6ff;">3</div><div class="step-title" style="color:#58a6ff;">ì‘ë‹µ ë°˜í™˜</div><div class="step-desc">ë°±ì—”ë“œ â†’ ì›¹/ì•±</div></div>
      <div class="info-box"><strong>ëŒ€ìƒ:</strong> research_projects ë©”íƒ€ + data_collection_configs + team_members(ê¶Œí•œ/ì¸ì› ì§‘ê³„)</div>
      <table class="t" style="margin-top:8px;">
        <tr><th>í•­ëª©</th><th>ê°’</th></tr>
        <tr><td>ê²½ìœ </td><td>ë°±ì—”ë“œ</td></tr>
        <tr><td>ë™ì˜ ê²€ì‚¬</td><td>ì„ íƒ(ë¯¼ê° ì•„ë‹˜)</td></tr>
        <tr><td>ì•µì»¤ë§</td><td>ì—†ìŒ</td></tr>
      </table>
    </div>
  </div>

  <div class="flow-panel fp-sensitive">
    <div class="flow-header">ğŸŸ£ FLOW 2 â€” ë¯¼ê° ë°ì´í„° ì¡°íšŒ (2-1/2-2/2-3)</div>
    <div class="flow-body">
      <div class="step"><div class="step-num" style="color:#bc8cff;">1</div><div class="step-title" style="color:#bc8cff;">ë¸”ë¡ì²´ì¸ ì„œë²„ ìš”ì²­</div><div class="step-desc">Passkey + ë™ì˜ ë²”ìœ„ ê¸°ë°˜</div></div>
      <div class="step-arrow">â–¼</div>
      <div class="step"><div class="step-num" style="color:#bc8cff;">2</div><div class="step-title" style="color:#bc8cff;">ì¸ì¦/ê¶Œí•œ/ë™ì˜ ê²€ì¦</div><div class="step-desc">ì—­í•  + scope + ê¸°ê°„ ê²€ì‚¬</div></div>
      <div class="subflow-branch">â‡© ê²€ì¦ ì™„ë£Œ í›„ 2-1(í™˜ì ë°ì´í„°) / 2-2(ì›¹ì…ë ¥ ë°ì´í„°ì…‹) / 2-3(í•©ì„±) ë¶„ê¸°</div>

      <div class="subflow-box">
        <div class="subflow-title">Flow2-1: UniQdata ì•± í™˜ì ë°ì´í„° ì¡°íšŒ</div>
        <div class="subflow-text">GET /blockchain/data/patient/*?ownerId=...&source=uniqdata_app â†’ data_points(value ì›ë¬¸, dataType, recordedAt) + agreements(dataScopes,startDate,endDate) ì¡°íšŒ</div>
      </div>
      <div class="subflow-box">
        <div class="subflow-title">Flow2-2: ì—”í„°í”„ë¼ì´ì¦ˆ ì›¹ ì…ë ¥ ë°ì´í„°ì…‹ ì¡°íšŒ</div>
        <div class="subflow-text">GET /blockchain/data/enterprise/*?projectId=...&source={enterprise_web_upload|institution_upload} â†’ data_points + research_projects(ë²”ìœ„) + team_members(ê¶Œí•œ) ì¡°íšŒ</div>
      </div>
      <div class="subflow-box">
        <div class="subflow-title">Flow2-3: í•©ì„± ë°ì´í„° ì¡°íšŒ (ì„œë²„ì¸¡ ì¡°í•©)</div>
        <div class="subflow-text">POST /blockchain/data/composite/query { ownerId, projectId, source[], time_window } â†’ (a) í™˜ì ì›ë¬¸ data_points ì¡°íšŒ + (b) ì›¹/ê¸°ê´€ data_points ì¡°íšŒ + (c) dataType/time_window ì •ë ¬ + (d) agreements.scope ë§ˆìŠ¤í‚¹ í›„ ë‹¨ì¼ composite ì‘ë‹µ</div>
      </div>
      <div class="subflow-merge">â‡© 2-1 í™˜ì ë°ì´í„° + 2-2 ì›¹ ì…ë ¥ ë°ì´í„°ì…‹ì„ ë¸”ë¡ì²´ì¸ ì„œë²„ì—ì„œ í•©ë¥˜ ì²˜ë¦¬</div>

      <div class="step-arrow">â–¼</div>
      <div class="step"><div class="step-num" style="color:#bc8cff;">3</div><div class="step-title" style="color:#bc8cff;">ê°ì‚¬ ê¸°ë¡</div><div class="step-desc">anchor_logs(anchorType=data_access) + agreements.anchorTx ì¦ì  ê¸°ë¡</div></div>
      <div class="warn-box"><strong>ì›ì¹™:</strong> ë¯¼ê° ì¡°íšŒëŠ” ë°±ì—”ë“œ ì§ì ‘ ì ‘ê·¼ ë¶ˆê°€, ë¸”ë¡ì²´ì¸ ê²½ìœ  ê³ ì •</div>
      <table class="t" style="margin-top:8px;">
        <tr><th>í•­ëª©</th><th>ê°’</th></tr>
        <tr><td>ê²½ìœ </td><td>ë¸”ë¡ì²´ì¸</td></tr>
        <tr><td>ë™ì˜ ê²€ì‚¬</td><td>ë§¤ ìš”ì²­</td></tr>
        <tr><td>í•©ì„± ìœ„ì¹˜</td><td>ë¸”ë¡ì²´ì¸ ì„œë²„</td></tr>
      </table>
    </div>
  </div>

  <div class="flow-panel fp-ai">
    <div class="flow-header">ğŸŸ¡ FLOW 3 â€” ë¸”ë¡ì²´ì¸ ê²½ìœ  AI ë¶„ì„</div>
    <div class="flow-body">
      <div class="step"><div class="step-num" style="color:#d29922;">1</div><div class="step-title" style="color:#d29922;">ë¶„ì„ ìš”ì²­</div><div class="step-desc">ë¯¼ê° ë°ì´í„° ì§ì ‘ ì „ë‹¬ ê¸ˆì§€</div><div class="step-code">POST /blockchain/ai/analyze</div></div>
      <div class="step-arrow">â–¼</div>
      <div class="step"><div class="step-num" style="color:#bc8cff;">2</div><div class="step-title" style="color:#bc8cff;">ë¸”ë¡ì²´ì¸ ê²€ì¦/í•„í„°</div><div class="step-desc">ê¶Œí•œ + ë™ì˜ + ì»¬ëŸ¼ ìµœì†Œí™” + ë¹„ì‹ë³„</div></div>
      <div class="step-arrow">â–¼</div>
      <div class="step"><div class="step-num" style="color:#d29922;">3</div><div class="step-title" style="color:#d29922;">AI ì„œë²„ ë¶„ì„</div><div class="step-desc">Stateless ì²˜ë¦¬ í›„ ì›ë³¸ íê¸°</div></div>
      <div class="step-arrow">â–¼</div>
      <div class="step"><div class="step-num" style="color:#bc8cff;">4</div><div class="step-title" style="color:#bc8cff;">ê²°ê³¼ í•´ì‹œ/ë¡œê·¸</div><div class="step-desc">anchor_logsì— ê²°ê³¼ ì¦ì  ì €ì¥</div></div>
      <div class="success-box"><strong>ë³´ì•ˆ:</strong> AI ì„œë²„ëŠ” DB direct access ì—†ìŒ</div>
      <table class="t" style="margin-top:8px;">
        <tr><th>í•­ëª©</th><th>ê°’</th></tr>
        <tr><td>ê²½ìœ </td><td>ë¸”ë¡ì²´ì¸ â†’ AI</td></tr>
        <tr><td>ì…ë ¥ ë°ì´í„°</td><td>í•„í„°/ë¹„ì‹ë³„ë§Œ</td></tr>
        <tr><td>ì•µì»¤ë§</td><td>ê²°ê³¼ í•´ì‹œ</td></tr>
      </table>
    </div>
  </div>

  <div class="flow-panel fp-audit">
    <div class="flow-header">ğŸŸ¢ FLOW 4 â€” í™˜ì ì•± ê°ì‚¬ê¸°ë¡ ì¡°íšŒ</div>
    <div class="flow-body">
      <div class="step"><div class="step-num" style="color:#3fb950;">1</div><div class="step-title" style="color:#3fb950;">í™˜ì ë³¸ì¸ ìš”ì²­</div><div class="step-desc">Passkey ì¬ê²€ì¦ ê°€ëŠ¥</div><div class="step-code">GET /blockchain/my-data/access-log</div></div>
      <div class="step-arrow">â–¼</div>
      <div class="step"><div class="step-num" style="color:#bc8cff;">2</div><div class="step-title" style="color:#bc8cff;">ë¸”ë¡ì²´ì¸ ë³¸ì¸í™•ì¸</div><div class="step-desc">íƒ€ì¸ ë¡œê·¸ ì ‘ê·¼ ì°¨ë‹¨</div></div>
      <div class="step-arrow">â–¼</div>
      <div class="step"><div class="step-num" style="color:#bc8cff;">3</div><div class="step-title" style="color:#bc8cff;">ì ‘ê·¼ê¸°ë¡ ì¡°íšŒ</div><div class="step-desc">ownerId ê¸°ì¤€ anchor_logs(anchorType=data_access) + agreements(anchorTx) ì°¸ì¡°</div></div>
      <div class="step-arrow">â–¼</div>
      <div class="step"><div class="step-num" style="color:#3fb950;">4</div><div class="step-title" style="color:#3fb950;">ì•±ì— ê°ì‚¬ê¸°ë¡ ì¶œë ¥</div><div class="step-desc">ëˆ„ê°€/ì–¸ì œ/ì–´ë–¤ ë²”ìœ„ ì¡°íšŒí–ˆëŠ”ì§€ ì œê³µ</div></div>
      <div class="info-box"><strong>êµ¬ë¶„:</strong> Flow2-1ì€ í™˜ì ì›ë¬¸ ë°ì´í„° ì¡°íšŒ, Flow4ëŠ” ë³¸ì¸ ì ‘ê·¼ê¸°ë¡(ê°ì‚¬ ë¡œê·¸) ì¡°íšŒ</div>
      <div class="success-box"><strong>íš¨ê³¼:</strong> ì°¸ì—¬ì íˆ¬ëª…ì„± í™•ë³´ + ë¶„ìŸ ì¦ì  ì œê³µ</div>
      <table class="t" style="margin-top:8px;">
        <tr><th>í•­ëª©</th><th>ê°’</th></tr>
        <tr><td>ê²½ìœ </td><td>ë¸”ë¡ì²´ì¸</td></tr>
        <tr><td>ëŒ€ìƒ</td><td>ë³¸ì¸ ì ‘ê·¼ê¸°ë¡ë§Œ</td></tr>
        <tr><td>ì¶œë ¥</td><td>ê¸°ë¡ + anchor_logs.txHash</td></tr>
      </table>
    </div>
  </div>
</div>

<!-- ROUTING MATRIX -->
<div class="section-divider"><span style="color:#e3b341;">ğŸ“‹ ì „ì²´ ë¼ìš°íŒ… ë§¤íŠ¸ë¦­ìŠ¤</span></div>

<table class="summary-table">
  <tr><th>êµ¬ë¶„</th><th>ì‘ì—…</th><th>ê²½ë¡œ</th><th>ì„œë²„</th><th>ì•µì»¤ë§/ê°ì‚¬</th></tr>
  <tr style="background:#58a6ff08;"><td>ì…ë ¥(ì“°ê¸°)</td><td>Medi Q ë¹„ë¯¼ê° ì…ë ¥</td><td class="tag-n">ğŸ”µ</td><td>ë°±ì—”ë“œ</td><td>data_points(value ë¹„ì‹ë³„, source=mediq)</td></tr>
  <tr style="background:#bc8cff08;"><td>ì…ë ¥(ì“°ê¸°)</td><td>Medi Q ë¯¼ê° ì…ë ¥</td><td class="tag-s">ğŸŸ£</td><td>ë¸”ë¡ì²´ì¸</td><td>DATA_SUBMIT + data_points(source=mediq) + agreements + anchor_logs</td></tr>
  <tr style="background:#58a6ff08;"><td>ì…ë ¥(ì“°ê¸°)</td><td>ë³´ë‹µ ë¹„ë¯¼ê° ì…ë ¥</td><td class="tag-n">ğŸ”µ</td><td>ë°±ì—”ë“œ</td><td>data_points(value ë¹„ì‹ë³„, source=bodap)</td></tr>
  <tr style="background:#bc8cff08;"><td>ì…ë ¥(ì“°ê¸°)</td><td>ë³´ë‹µ ë¯¼ê° ì…ë ¥</td><td class="tag-s">ğŸŸ£</td><td>ë¸”ë¡ì²´ì¸</td><td>DATA_SUBMIT + data_points(source=bodap) + agreements + anchor_logs</td></tr>
  <tr style="background:#58a6ff08;"><td>ì…ë ¥(ì“°ê¸°)</td><td>UniQdata ì•± ë¹„ë¯¼ê° ì…ë ¥</td><td class="tag-n">ğŸ”µ</td><td>ë°±ì—”ë“œ</td><td>data_points(value ë¹„ì‹ë³„, source=uniqdata_app)</td></tr>
  <tr style="background:#bc8cff08;"><td>ì…ë ¥(ì“°ê¸°)</td><td>UniQdata ì•± ë¯¼ê° ì…ë ¥</td><td class="tag-s">ğŸŸ£</td><td>ë¸”ë¡ì²´ì¸</td><td>DATA_SUBMIT + data_points(source=uniqdata_app) + agreements + anchor_logs</td></tr>
  <tr style="background:#58a6ff08;"><td>ì…ë ¥(ì“°ê¸°)</td><td>ì›¹Â·ê¸°ê´€ ë¹„ë¯¼ê° ì—…ë¡œë“œ</td><td class="tag-n">ğŸ”µ</td><td>ë°±ì—”ë“œ</td><td>data_points(value ë¹„ì‹ë³„, source={enterprise_web_upload|institution_upload})</td></tr>
  <tr style="background:#bc8cff08;"><td>ì…ë ¥(ì“°ê¸°)</td><td>ì›¹Â·ê¸°ê´€ ë¯¼ê° ì—…ë¡œë“œ</td><td class="tag-s">ğŸŸ£</td><td>ë¸”ë¡ì²´ì¸</td><td>DATA_SUBMIT + data_points(source={enterprise_web_upload|institution_upload}) + agreements + anchor_logs</td></tr>
  <tr><td>ì¶œë ¥(ì¡°íšŒ/í™œìš©)</td><td>FLOW 1 ë¹„ë¯¼ê° ì¡°íšŒ (í”„ë¡œì íŠ¸ ë©”íƒ€/ì„¤ì •)</td><td class="tag-n">ğŸ”µ</td><td>ë°±ì—”ë“œ</td><td>research_projects + data_collection_configs + ì¼ë°˜ ë¡œê·¸</td></tr>
  <tr><td>ì¶œë ¥(ì¡°íšŒ/í™œìš©)</td><td>FLOW 2-1 UniQdata ì•± í™˜ì ë°ì´í„° ì¡°íšŒ</td><td class="tag-s">ğŸŸ£</td><td>ë¸”ë¡ì²´ì¸</td><td>DATA_ACCESS + anchor_logs + agreements</td></tr>
  <tr><td>ì¶œë ¥(ì¡°íšŒ/í™œìš©)</td><td>FLOW 2-2 ì—”í„°í”„ë¼ì´ì¦ˆ ì›¹ ì…ë ¥ ë°ì´í„°ì…‹ ì¡°íšŒ</td><td class="tag-s">ğŸŸ£</td><td>ë¸”ë¡ì²´ì¸</td><td>DATASET_ACCESS</td></tr>
  <tr><td>ì¶œë ¥(ì¡°íšŒ/í™œìš©)</td><td>FLOW 2-3 í•©ì„± ì¡°íšŒ (2-1 + 2-2)</td><td class="tag-s">ğŸŸ£</td><td>ë¸”ë¡ì²´ì¸(í•©ì„±)</td><td>DATA_ACCESS + anchor_logs + agreements ë²”ìœ„ê²€ì¦</td></tr>
  <tr><td>ì¶œë ¥(ì¡°íšŒ/í™œìš©)</td><td>FLOW 3 AI ë¶„ì„</td><td class="tag-ai">ğŸŸ¡</td><td>BC â†’ AI</td><td>AI_ANALYSIS + anchor_logs(metadata, txHash)</td></tr>
  <tr><td>ì¶œë ¥(ì¡°íšŒ/í™œìš©)</td><td>FLOW 4 í™˜ì ê°ì‚¬ê¸°ë¡ ì¡°íšŒ</td><td class="tag-s">ğŸŸ£</td><td>ë¸”ë¡ì²´ì¸</td><td>anchor_logs + agreements.anchorTx</td></tr>
</table>

<div class="legend">
  <span><span style="color:#bc8cff;">ğŸŸ£</span> ë¯¼ê°: ë¸”ë¡ì²´ì¸ ê²½ìœ </span>
  <span><span style="color:#58a6ff;">ğŸ”µ</span> ë¹„ë¯¼ê°: ë°±ì—”ë“œ ì§ì ‘</span>
  <span><span style="color:#d29922;">ğŸŸ¡</span> AI: BC â†’ AI</span>
  <span><span style="color:#79c0ff;">íƒ€ì…</span> sensitivity = sensitive | non_sensitive</span>
</div>

<!-- APPENDIX -->
<div class="section-divider"><span style="color:#8b949e;">ë¶€ë¡ â€” ë³´ì¡° ì •ë³´</span></div>

<div class="layer" style="border-color:#30363d;">
  <div class="layer-header" style="background:#161b22; color:#79c0ff;">ğŸ“Š ì—­í•  êµ¬ì¡°</div>
  <div class="layer-body">
    <div class="role-grid">
      <div class="role-card">
        <h4>ğŸ¢ Workspace (ì—”í„°í”„ë¼ì´ì¦ˆ)</h4>
        <div class="role-row"><span class="role-name">OWNER</span><span class="role-desc">ì›Œí¬ìŠ¤í˜ì´ìŠ¤ ìƒì„±ì</span></div>
        <div class="role-row"><span class="role-name">ADMIN</span><span class="role-desc">ì˜ˆì‚°/í”„ë¡œì íŠ¸/ë°ì´í„°ì…‹ ê´€ë¦¬</span></div>
        <div class="role-row"><span class="role-name">MEMBER</span><span class="role-desc">í”„ë¡œì íŠ¸ ì°¸ì—¬/ë°ì´í„° ìš”ì²­</span></div>
        <div class="role-row"><span class="role-name">AUDITOR</span><span class="role-desc">ê°ì‚¬ ë¡œê·¸ ì½ê¸° ì „ìš©</span></div>
      </div>
      <div class="role-card">
        <h4>ğŸ”¬ Project (ì—°êµ¬)</h4>
        <div class="role-row"><span class="role-name">owner</span><span class="role-desc">PI/ê²°ì •ê¶Œì</span></div>
        <div class="role-row"><span class="role-name">member</span><span class="role-desc">ì¡°íšŒ/ë¶„ì„ ì‹¤í–‰</span></div>
      </div>
    </div>
  </div>
</div>

<div class="layer enterprise-layer">
  <div class="layer-header">ğŸ“¦ ì›Œí¬ìŠ¤í˜ì´ìŠ¤ ë°ì´í„° ì¹´íƒˆë¡œê·¸ + ì—…ë¡œë“œ/ì ‘ê·¼</div>
  <div class="layer-body">
    <div class="cards" style="margin-bottom:10px;">
      <div class="card">
        <div class="card-title" style="color:#e3b341;">ë¶„ë¥˜ ê·œì¹™</div>
        <table class="t">
          <tr><th>ë¶„ë¥˜</th><th>ì €ì¥/ì¡°íšŒ ê²½ë¡œ</th><th>ê°ì‚¬</th></tr>
          <tr><td class="tag-s">ë¯¼ê°</td><td>ë¸”ë¡ì²´ì¸ ì„œë²„ â†’ enterprise_datasets + dataset_access_logs</td><td>XRPL(anchor_logs)</td></tr>
          <tr><td class="tag-n">ë¹„ë¯¼ê°</td><td>ë°±ì—”ë“œ ì„œë²„ â†’ dataset_catalog + researcher_datasets</td><td>DB ë¡œê·¸</td></tr>
        </table>
      </div>
      <div class="card">
        <div class="card-title" style="color:#e3b341;">í•µì‹¬ í…Œì´ë¸”</div>
        <table class="t">
          <tr><th>í…Œì´ë¸”</th><th>ì—­í• </th></tr>
          <tr><td>dataset_catalog</td><td>ë©”íƒ€/ê²€ìƒ‰</td></tr>
          <tr><td>researcher_datasets</td><td>ë¹„ë¯¼ê° ì‹¤ì œ ë°ì´í„°</td></tr>
          <tr><td>enterprise_datasets</td><td>ë¯¼ê° ì‹¤ì œ ë°ì´í„°</td></tr>
          <tr><td>dataset_access_logs</td><td>ì ‘ê·¼ ê°ì‚¬/ì¦ì </td></tr>
        </table>
      </div>
    </div>

    <div class="ent-flow-grid">
      <div style="border:2px solid #e3b34144; border-radius:8px; overflow:hidden;">
        <div style="padding:9px 12px; background:#2a2a1a; color:#e3b341; font-size:11px; font-weight:700; text-align:center;">ğŸ“¥ PART 1 / FLOW A â€” DB ì…ë ¥ (ì›¹ ì—…ë¡œë“œ)</div>
        <div style="padding:10px; background:#0d1117;">
          <div class="step"><div class="step-num" style="color:#3fb950;">1</div><div class="step-title" style="color:#3fb950;">UniQdata ì›¹ ì—…ë¡œë“œ</div><div class="step-desc">POST /api/datasets/upload + sensitivity ì§€ì •</div></div>
          <div class="step-arrow">â–¼</div>
          <div class="step"><div class="step-num" style="color:#58a6ff;">2</div><div class="step-title" style="color:#58a6ff;">ë°±ì—”ë“œ ì¹´íƒˆë¡œê·¸ ë“±ë¡</div><div class="step-desc">dataset_catalog ìƒì„± + ìŠ¤í‚¤ë§ˆ ê²€ì¦/PII ê²€ì‚¬</div></div>
          <div class="step-arrow">â–¼</div>
          <div class="step"><div class="step-num" style="color:#e3b341;">3</div><div class="step-title" style="color:#e3b341;">ë¯¼ê°ë„ ë¶„ê¸° ì €ì¥</div><div class="step-desc">ë¯¼ê°â†’BC/enterprise_datasets+dataset_access_logs+anchor_logs, ë¹„ë¯¼ê°â†’BE/dataset_catalog+researcher_datasets+DB ë¡œê·¸</div></div>
        </div>
      </div>
      <div style="border:2px solid #3fb95044; border-radius:8px; overflow:hidden;">
        <div style="padding:9px 12px; background:#1a3a2a; color:#3fb950; font-size:11px; font-weight:700; text-align:center;">ğŸ”“ PART 2 / FLOW B â€” DB ì¡°íšŒ (ì ‘ê·¼/ìŠ¹ì¸/ê°ì‚¬)</div>
        <div style="padding:10px; background:#0d1117;">
          <div class="step"><div class="step-num" style="color:#3fb950;">1</div><div class="step-title" style="color:#3fb950;">ì ‘ê·¼ ìš”ì²­</div><div class="step-desc">/api/datasets/{id}/request-access</div></div>
          <div class="step-arrow">â–¼</div>
          <div class="step"><div class="step-num" style="color:#58a6ff;">2</div><div class="step-title" style="color:#58a6ff;">ìŠ¹ì¸/ê±°ì ˆ ê¸°ë¡</div><div class="step-desc">grant ê¸°ê°„/ë²”ìœ„ ì €ì¥</div></div>
          <div class="step-arrow">â–¼</div>
          <div class="step"><div class="step-num" style="color:#bc8cff;">3</div><div class="step-title" style="color:#bc8cff;">ì‹¤ì œ ì ‘ê·¼ ê°ì‚¬</div><div class="step-desc">ë¯¼ê° ì ‘ê·¼ì€ BC(data_usage_records+dataset_access_logs+anchor), ë¹„ë¯¼ê°ì€ BE(DB/request ë¡œê·¸)</div></div>
        </div>
      </div>
    </div>
  </div>
</div>

</body>
</html>
