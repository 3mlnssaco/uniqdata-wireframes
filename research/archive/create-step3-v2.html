<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>ì—°êµ¬ ìƒì„± Step 3 - ë°ì´í„° êµ¬ì„± (v2) - Wireframe</title>
  <style>
    * { margin: 0; padding: 0; box-sizing: border-box; }
    body { font-family: -apple-system, 'Pretendard', sans-serif; background: #f5f5f5; }

    /* ===== ë ˆì´ì•„ì›ƒ ===== */
    .layout { display: flex; min-height: 100vh; width: 100%; }

    /* Nav (ì¢Œì¸¡ ì‚¬ì´ë“œë°”) */
    .sidebar {
      width: 240px;
      background: linear-gradient(180deg, #0f172a 0%, #1e293b 100%);
      color: white;
      display: flex; flex-direction: column; flex-shrink: 0;
    }
    .logo {
      padding: 20px 24px; font-size: 20px; font-weight: 700;
      border-bottom: 1px solid rgba(255,255,255,0.1);
      display: flex; align-items: center; gap: 10px;
    }
    .logo-icon {
      width: 32px; height: 32px;
      background: linear-gradient(135deg, #3b82f6, #8b5cf6);
      border-radius: 8px; display: flex; align-items: center; justify-content: center;
      font-size: 16px; font-weight: bold;
    }
    .nav-section { padding: 16px 12px; border-bottom: 1px solid rgba(255,255,255,0.05); }
    .nav-section-title { font-size: 11px; text-transform: uppercase; color: #64748b; padding: 8px 12px; letter-spacing: 0.5px; }
    .nav-item {
      display: flex; align-items: center; gap: 12px;
      padding: 10px 12px; border-radius: 8px; color: #94a3b8;
      cursor: pointer; font-size: 14px; text-decoration: none; transition: all 0.15s;
    }
    .nav-item:hover { background: rgba(255,255,255,0.05); color: #e2e8f0; }
    .nav-item.active { background: rgba(59, 130, 246, 0.2); color: #60a5fa; }
    .nav-item .icon { width: 20px; text-align: center; }
    .sidebar-footer {
      margin-top: auto; padding: 16px; border-top: 1px solid rgba(255,255,255,0.05);
    }
    .user-info-sidebar { display: flex; align-items: center; gap: 12px; padding: 8px; }
    .user-avatar-sidebar {
      width: 36px; height: 36px;
      background: linear-gradient(135deg, #3b82f6, #8b5cf6);
      border-radius: 50%; display: flex; align-items: center; justify-content: center;
      font-size: 14px; color: white;
    }
    .user-name-sidebar { font-size: 14px; color: #e2e8f0; }
    .user-org-sidebar { font-size: 12px; color: #64748b; }

    /* Workspace */
    .workspace-wrap { flex: 1; display: flex; flex-direction: column; min-width: 0; }
    .workspace { flex: 1; display: flex; min-height: 0; }

    /* Step Bar â€” ë¹„ì„ í˜• */
    .step-bar {
      background: #1e293b; border-bottom: 1px solid #334155;
      padding: 10px 0; flex-shrink: 0;
    }
    .step-bar-inner {
      display: flex; align-items: center; justify-content: center; gap: 0;
      max-width: 700px; margin: 0 auto;
    }
    .sb-step {
      display: flex; flex-direction: column; align-items: center; gap: 4px;
      cursor: pointer; text-decoration: none; color: inherit;
      position: relative;
    }
    .sb-step:hover .sb-num { transform: scale(1.1); }
    .sb-step:hover .sb-label { color: #e2e8f0; }
    .sb-num {
      width: 28px; height: 28px; border-radius: 50%;
      display: flex; align-items: center; justify-content: center;
      font-size: 12px; font-weight: 600; transition: all 0.15s;
    }
    .sb-step.done .sb-num { background: #22c55e; color: white; }
    .sb-step.active .sb-num { background: #8b5cf6; color: white; box-shadow: 0 0 0 3px rgba(139,92,246,0.3); }
    .sb-step.available .sb-num { background: #475569; color: #e2e8f0; border: 2px dashed #64748b; }
    .sb-step.pending .sb-num { background: #334155; color: #64748b; }
    .sb-step.skipped .sb-num { background: #1e293b; color: #475569; border: 1px solid #475569; }
    .sb-label { font-size: 10px; color: #64748b; white-space: nowrap; }
    .sb-step.active .sb-label { color: #e2e8f0; font-weight: 600; }
    .sb-step.done .sb-label { color: #86efac; }
    .sb-line { width: 40px; height: 2px; background: #334155; margin: 0 4px; margin-bottom: 18px; }
    .sb-line.done { background: #22c55e; }
    /* ìŠ¤í‚µëœ ìŠ¤í… ë¼ì¸ */
    .sb-line.skipped { background: #475569; border-top: 2px dashed #475569; height: 0; }
    /* ì—°êµ¬ìœ í˜• ë±ƒì§€ */
    .research-type-badge {
      position: absolute; top: -16px; left: 50%; transform: translateX(-50%);
      font-size: 9px; padding: 1px 6px; border-radius: 4px;
      white-space: nowrap;
    }
    .badge-retro { background: #164e63; color: #67e8f9; }
    .badge-pro { background: #4c1d95; color: #c4b5fd; }
    .badge-both { background: #713f12; color: #fde68a; }

    /* ì—ë””í„° íŒ¨ë„ */
    .editor-panel { flex: 1; overflow-y: auto; padding: 28px 32px; background: #f8fafc; }

    /* ìƒë‹¨ í—¤ë” */
    .page-header { margin-bottom: 24px; }
    .page-header h2 { font-size: 22px; font-weight: 700; color: #0f172a; margin-bottom: 4px; }
    .page-header p { font-size: 13px; color: #64748b; }

    /* ===== ë°ì´í„° ì†ŒìŠ¤ í† ê¸€ ì¹´ë“œ ===== */
    .source-cards { display: flex; gap: 16px; margin-bottom: 24px; }
    .source-toggle {
      flex: 1; padding: 20px; border-radius: 14px;
      border: 2px solid #e2e8f0; background: white;
      cursor: pointer; transition: all 0.25s; position: relative;
    }
    .source-toggle:hover { border-color: #cbd5e1; box-shadow: 0 2px 12px rgba(0,0,0,0.06); }
    .source-toggle.active-a { border-color: #06b6d4; background: linear-gradient(135deg, #ecfeff, #f0fdfa); }
    .source-toggle.active-b { border-color: #8b5cf6; background: linear-gradient(135deg, #faf5ff, #f5f3ff); }
    .source-toggle.active-a:hover { border-color: #0891b2; }
    .source-toggle.active-b:hover { border-color: #7c3aed; }

    .source-toggle-header { display: flex; align-items: center; gap: 12px; margin-bottom: 10px; }
    .source-icon { font-size: 28px; }
    .source-title { font-size: 16px; font-weight: 700; color: #0f172a; }
    .source-subtitle { font-size: 12px; color: #64748b; }
    .source-desc { font-size: 13px; color: #475569; line-height: 1.6; margin-bottom: 12px; }
    .source-examples { display: flex; flex-wrap: wrap; gap: 6px; }
    .source-example-tag {
      font-size: 11px; padding: 3px 10px; border-radius: 20px;
      background: #f1f5f9; color: #64748b;
    }
    .source-toggle.active-a .source-example-tag { background: #cffafe; color: #0e7490; }
    .source-toggle.active-b .source-example-tag { background: #ede9fe; color: #6d28d9; }

    /* í† ê¸€ ìŠ¤ìœ„ì¹˜ */
    .toggle-switch {
      position: absolute; top: 16px; right: 16px;
      width: 44px; height: 24px; border-radius: 12px;
      background: #d1d5db; cursor: pointer; transition: all 0.25s;
    }
    .toggle-switch::after {
      content: ''; position: absolute; top: 3px; left: 3px;
      width: 18px; height: 18px; border-radius: 50%;
      background: white; transition: all 0.25s;
      box-shadow: 0 1px 3px rgba(0,0,0,0.2);
    }
    .toggle-switch.on { background: #06b6d4; }
    .toggle-switch.on-b { background: #8b5cf6; }
    .toggle-switch.on::after, .toggle-switch.on-b::after { left: 23px; }

    /* ëª¨ë“œ ì¸ë””ì¼€ì´í„° */
    .mode-indicator {
      text-align: center; padding: 10px 20px; border-radius: 10px;
      margin-bottom: 24px; font-size: 13px; font-weight: 600;
      transition: all 0.3s;
    }
    .mode-retro { background: #ecfeff; color: #0891b2; border: 1px solid #a5f3fc; }
    .mode-pro { background: #faf5ff; color: #7c3aed; border: 1px solid #ddd6fe; }
    .mode-mixed { background: #fffbeb; color: #b45309; border: 1px solid #fde68a; }
    .mode-none { background: #f1f5f9; color: #94a3b8; border: 1px solid #e2e8f0; }

    /* ===== íŒ¨ë„ ì½˜í…ì¸  ===== */
    .panel-content { transition: all 0.3s; }
    .panel-content.hidden { display: none; }

    /* ì¹´ë“œ ê³µí†µ */
    .card {
      background: white; border: 1px solid #e5e7eb; border-radius: 12px;
      margin-bottom: 20px; overflow: hidden;
    }
    .card-header {
      padding: 16px 20px; border-bottom: 1px solid #e5e7eb;
      display: flex; justify-content: space-between; align-items: center;
    }
    .card-header h3 { font-size: 16px; font-weight: 600; }
    .card-body { padding: 20px; }
    .card-header-a { background: #ecfeff; }
    .card-header-b { background: #faf5ff; }
    .ai-badge { font-size: 11px; color: #7c3aed; background: #f3e8ff; padding: 4px 10px; border-radius: 12px; }
    .cdm-badge { font-size: 11px; color: #0891b2; background: #cffafe; padding: 4px 10px; border-radius: 12px; }

    /* ===== ì¹´ë“œ A: ê¸°ì¡´ ë°ì´í„° ===== */
    .cdm-table-grid { display: grid; grid-template-columns: repeat(3, 1fr); gap: 10px; margin-bottom: 20px; }
    .cdm-table-item {
      padding: 14px; border: 2px solid #e5e7eb; border-radius: 10px;
      cursor: pointer; transition: all 0.2s; text-align: center;
    }
    .cdm-table-item:hover { border-color: #67e8f9; }
    .cdm-table-item.selected { border-color: #06b6d4; background: #ecfeff; }
    .cdm-table-item .tbl-icon { font-size: 24px; margin-bottom: 6px; }
    .cdm-table-item .tbl-name { font-size: 13px; font-weight: 600; color: #0f172a; }
    .cdm-table-item .tbl-desc { font-size: 11px; color: #64748b; margin-top: 2px; }
    .cdm-table-item .tbl-count { font-size: 10px; color: #0891b2; margin-top: 4px; font-weight: 600; }

    /* ê¸°ê°„ ì„ íƒ */
    .date-range { display: flex; align-items: center; gap: 12px; margin-bottom: 20px; }
    .date-input {
      padding: 10px 14px; border: 1px solid #d1d5db; border-radius: 8px;
      font-size: 13px; color: #374151; background: white; width: 160px;
    }
    .date-sep { color: #94a3b8; font-size: 14px; }

    /* ì½”í˜¸íŠ¸ í•„í„° */
    .filter-row {
      display: flex; align-items: center; gap: 10px;
      padding: 10px 14px; background: #f8fafc; border-radius: 8px;
      margin-bottom: 8px;
    }
    .filter-field {
      padding: 6px 12px; border: 1px solid #d1d5db; border-radius: 6px;
      font-size: 13px; background: white; min-width: 140px;
    }
    .filter-op {
      padding: 6px 10px; border: 1px solid #d1d5db; border-radius: 6px;
      font-size: 12px; background: white; color: #6b7280;
    }
    .filter-val {
      padding: 6px 12px; border: 1px solid #d1d5db; border-radius: 6px;
      font-size: 13px; background: white; flex: 1;
    }
    .filter-remove { cursor: pointer; color: #ef4444; font-size: 16px; padding: 4px; }
    .add-filter-btn {
      display: inline-flex; align-items: center; gap: 6px;
      padding: 8px 14px; border: 1px dashed #94a3b8; border-radius: 8px;
      font-size: 13px; color: #64748b; cursor: pointer; background: none;
      margin-top: 4px;
    }
    .add-filter-btn:hover { border-color: #06b6d4; color: #06b6d4; }

    /* ë°ì´í„° í”„ë¦¬ë·° */
    .data-preview {
      background: #f0fdfa; border: 1px solid #99f6e4; border-radius: 10px;
      padding: 16px 20px; display: flex; align-items: center; gap: 16px;
    }
    .preview-stat { text-align: center; }
    .preview-num { font-size: 28px; font-weight: 800; color: #0891b2; }
    .preview-label { font-size: 11px; color: #64748b; }
    .preview-divider { width: 1px; height: 40px; background: #99f6e4; }
    .preview-chart {
      flex: 1; height: 60px; background: #ccfbf1; border-radius: 8px;
      display: flex; align-items: flex-end; padding: 0 8px; gap: 3px;
    }
    .preview-bar {
      flex: 1; background: #14b8a6; border-radius: 3px 3px 0 0;
      min-height: 4px; transition: height 0.3s;
    }

    /* ===== ì¹´ë“œ B: ì‹ ê·œ ìˆ˜ì§‘ ===== */
    .data-category { margin-bottom: 24px; }
    .data-category-title {
      font-size: 14px; font-weight: 600; color: #374151;
      margin-bottom: 12px; display: flex; align-items: center; gap: 8px;
    }
    .data-grid { display: grid; grid-template-columns: repeat(2, 1fr); gap: 10px; }
    .data-item {
      padding: 14px 16px; border: 2px solid #e5e7eb; border-radius: 10px;
      cursor: pointer; transition: all 0.2s; display: flex; align-items: center; gap: 12px;
    }
    .data-item:hover { border-color: #c4b5fd; }
    .data-item.selected { border-color: #8b5cf6; background: #faf5ff; }
    .data-item .icon { font-size: 20px; }
    .data-item .info { flex: 1; }
    .data-item .name { font-size: 14px; font-weight: 500; margin-bottom: 2px; }
    .data-item .desc { font-size: 11px; color: #6b7280; }

    /* EMA ì„¤ì • */
    .ema-section { background: #faf5ff; border-radius: 10px; padding: 16px; margin-top: 16px; }
    .ema-row {
      display: flex; align-items: center; gap: 12px;
      padding: 8px 0; border-bottom: 1px solid #ede9fe;
    }
    .ema-row:last-child { border-bottom: none; }
    .ema-name { width: 120px; font-size: 13px; font-weight: 500; }
    .ema-freq {
      padding: 6px 10px; border: 1px solid #ddd6fe; border-radius: 6px;
      font-size: 12px; background: white; width: 100px; text-align: center;
    }
    .ema-timing { font-size: 11px; color: #7c3aed; }

    /* ì°¸ì—¬ì ë¶€ë‹´ë„ */
    .burden-meter {
      background: white; border: 1px solid #e5e7eb; border-radius: 10px;
      padding: 16px 20px; margin-top: 16px;
    }
    .burden-bar-bg {
      height: 8px; background: #f1f5f9; border-radius: 4px;
      margin: 10px 0 6px; overflow: hidden;
    }
    .burden-bar-fill {
      height: 100%; border-radius: 4px; transition: width 0.3s;
    }
    .burden-low { background: #22c55e; }
    .burden-mid { background: #f59e0b; }
    .burden-high { background: #ef4444; }
    .burden-label { display: flex; justify-content: space-between; font-size: 11px; color: #6b7280; }

    /* ===== í•˜ë‹¨ ìš”ì•½ ===== */
    .summary-bar {
      background: white; border-top: 1px solid #e2e8f0;
      padding: 16px 32px; display: flex; align-items: center; justify-content: space-between;
    }
    .summary-chips { display: flex; gap: 8px; flex-wrap: wrap; }
    .summary-chip {
      padding: 6px 14px; border-radius: 20px; font-size: 12px; font-weight: 500;
    }
    .chip-a { background: #ecfeff; color: #0891b2; border: 1px solid #a5f3fc; }
    .chip-b { background: #faf5ff; color: #7c3aed; border: 1px solid #ddd6fe; }
    .chip-neutral { background: #f1f5f9; color: #64748b; border: 1px solid #e2e8f0; }
    .nav-buttons { display: flex; gap: 10px; }
    .btn-secondary {
      padding: 10px 20px; border: 1px solid #d1d5db; border-radius: 8px;
      background: white; font-size: 14px; color: #374151; cursor: pointer;
    }
    .btn-primary {
      padding: 10px 24px; border: none; border-radius: 8px;
      background: linear-gradient(135deg, #7c3aed, #6d28d9); color: white;
      font-size: 14px; font-weight: 600; cursor: pointer;
    }
    .btn-primary:hover { background: linear-gradient(135deg, #6d28d9, #5b21b6); }

    /* ìš°ì¸¡ AI íŒ¨ë„ */
    .ai-panel {
      width: 300px; background: #f9fafb; border-left: 1px solid #e5e7eb;
      padding: 20px; overflow-y: auto; flex-shrink: 0;
    }
    .ai-panel-title { font-size: 14px; font-weight: 600; margin-bottom: 16px; display: flex; align-items: center; gap: 8px; }
    .ai-suggestion {
      background: white; border: 1px solid #e5e7eb; border-radius: 10px;
      padding: 14px; margin-bottom: 12px;
    }
    .ai-suggestion-title { font-size: 12px; font-weight: 600; color: #374151; margin-bottom: 6px; }
    .ai-suggestion-text { font-size: 12px; color: #6b7280; line-height: 1.6; }
    .ai-suggestion .highlight { color: #7c3aed; font-weight: 500; }
    .ai-impact {
      margin-top: 8px; padding: 8px 10px; border-radius: 6px;
      font-size: 11px; display: flex; align-items: center; gap: 6px;
    }
    .impact-green { background: #f0fdf4; color: #16a34a; }
    .impact-yellow { background: #fffbeb; color: #d97706; }
    .impact-blue { background: #eff6ff; color: #2563eb; }

    /* ë‹¤í¬ ë¼ë²¨ */
    .section-label {
      font-size: 11px; text-transform: uppercase; letter-spacing: 0.5px;
      color: #94a3b8; margin-bottom: 8px; font-weight: 600;
    }

    /* Mixed í‘œì‹œ í™”ì‚´í‘œ */
    .flow-arrow {
      text-align: center; padding: 8px; color: #d97706; font-size: 20px;
    }
    .flow-label {
      text-align: center; font-size: 11px; color: #92400e;
      background: #fef3c7; padding: 4px 12px; border-radius: 20px;
      display: inline-block; margin: 0 auto;
    }
  </style>
</head>
<body>
  <div class="layout">
    <!-- ì¢Œì¸¡ ì‚¬ì´ë“œë°” -->
    <nav class="sidebar">
      <div class="logo">
        <div class="logo-icon">U</div>
        UniQdata
      </div>
      <div class="nav-section">
        <div class="nav-section-title">ì—°êµ¬ ê´€ë¦¬</div>
        <a class="nav-item" href="#"><span class="icon">ğŸ“‹</span> ì—°êµ¬ ëª©ë¡</a>
        <a class="nav-item active" href="#"><span class="icon">â•</span> ìƒˆ ì—°êµ¬</a>
      </div>
      <div class="nav-section">
        <div class="nav-section-title">ì§„í–‰ ì¤‘</div>
        <a class="nav-item" href="#">
          <span class="icon">ğŸ”¬</span>
          <div>
            <div style="font-size:13px;">ë‹¹ë‡¨ë³‘ ë³µì•½ ìˆœì‘ë„</div>
            <div style="font-size:11px; color:#64748b;">Retrospective</div>
          </div>
        </a>
        <a class="nav-item" href="#">
          <span class="icon">ğŸ§ª</span>
          <div>
            <div style="font-size:13px;">ë…¸ì¸ ìˆ˜ë©´ íŒ¨í„´ ì—°êµ¬</div>
            <div style="font-size:11px; color:#64748b;">Mixed</div>
          </div>
        </a>
        <a class="nav-item" href="#">
          <span class="icon">ğŸ“</span>
          <div>
            <div style="font-size:13px;">ADHD ìƒí™œìŠµê´€ ì¶”ì </div>
            <div style="font-size:11px; color:#64748b;">Prospective</div>
          </div>
        </a>
      </div>
      <div class="sidebar-footer">
        <div class="user-info-sidebar">
          <div class="user-avatar-sidebar">ì´</div>
          <div>
            <div class="user-name-sidebar">ì´ìŠ¹í—Œ</div>
            <div class="user-org-sidebar">UniQdata</div>
          </div>
        </div>
      </div>
    </nav>

    <div class="workspace-wrap">
      <!-- Step Bar (ë¹„ì„ í˜•) -->
      <div class="step-bar">
        <div class="step-bar-inner">
          <a class="sb-step done" href="#">
            <div class="sb-num">âœ“</div>
            <div class="sb-label">AI ì¸í„°ë·°</div>
          </a>
          <div class="sb-line done"></div>
          <a class="sb-step done" href="#">
            <div class="sb-num">âœ“</div>
            <div class="sb-label">ì—°êµ¬ ì„¤ê³„</div>
          </a>
          <div class="sb-line done"></div>
          <a class="sb-step active" href="#">
            <div class="sb-num">3</div>
            <div class="sb-label">ë°ì´í„° êµ¬ì„±</div>
          </a>
          <div class="sb-line"></div>
          <a class="sb-step available" href="#" id="step4-link">
            <div class="sb-num">4</div>
            <div class="sb-label" id="step4-label">íƒ€ê²Ÿ ì„¤ì •</div>
          </a>
          <div class="sb-line"></div>
          <a class="sb-step available" href="#">
            <div class="sb-num">5</div>
            <div class="sb-label">IRB ì‹¬ì˜</div>
          </a>
          <div class="sb-line"></div>
          <a class="sb-step available" href="#">
            <div class="sb-num">6</div>
            <div class="sb-label">ì—ìŠ¤í¬ë¡œ</div>
          </a>
        </div>
      </div>

      <div class="workspace">
        <!-- ë©”ì¸ ì—ë””í„° -->
        <div class="editor-panel" id="editor">
          <div class="page-header">
            <h2>Step 3. ë°ì´í„° êµ¬ì„±</h2>
            <p>ì—°êµ¬ì— í•„ìš”í•œ ë°ì´í„° ì†ŒìŠ¤ë¥¼ ì„ íƒí•˜ì„¸ìš”. ê¸°ì¡´ ë°ì´í„°ì™€ ì‹ ê·œ ìˆ˜ì§‘ì„ ììœ ë¡­ê²Œ ì¡°í•©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>
          </div>

          <!-- ===== ë°ì´í„° ì†ŒìŠ¤ í† ê¸€ ì¹´ë“œ ===== -->
          <div class="source-cards">
            <!-- ì¹´ë“œ A: ê¸°ì¡´ ë°ì´í„° -->
            <div class="source-toggle active-a" id="card-a" onclick="toggleSource('a')">
              <div class="toggle-switch on" id="toggle-a"></div>
              <div class="source-toggle-header">
                <div class="source-icon">ğŸ—„ï¸</div>
                <div>
                  <div class="source-title">ê¸°ì¡´ ë°ì´í„°</div>
                  <div class="source-subtitle">Existing Data</div>
                </div>
              </div>
              <div class="source-desc">
                ì´ë¯¸ ìˆ˜ì§‘ëœ ë°ì´í„°ë¥¼ ê°€ì ¸ì™€ ë¶„ì„í•©ë‹ˆë‹¤. ë³‘ì› EMR, CDM ë°ì´í„°, ê³¼ê±° ì›¨ì–´ëŸ¬ë¸” ê¸°ë¡ ë“±.
              </div>
              <div class="source-examples">
                <span class="source-example-tag">EMR/EHR</span>
                <span class="source-example-tag">OMOP CDM</span>
                <span class="source-example-tag">ê³¼ê±° ì›¨ì–´ëŸ¬ë¸”</span>
                <span class="source-example-tag">ê±´ê°•ë³´í—˜</span>
              </div>
            </div>

            <!-- ì¹´ë“œ B: ì‹ ê·œ ìˆ˜ì§‘ -->
            <div class="source-toggle active-b" id="card-b" onclick="toggleSource('b')">
              <div class="toggle-switch on-b" id="toggle-b"></div>
              <div class="source-toggle-header">
                <div class="source-icon">ğŸ“±</div>
                <div>
                  <div class="source-title">ì‹ ê·œ ìˆ˜ì§‘</div>
                  <div class="source-subtitle">New Collection</div>
                </div>
              </div>
              <div class="source-desc">
                ì°¸ì—¬ìë¡œë¶€í„° ìƒˆë¡œìš´ ë°ì´í„°ë¥¼ ìˆ˜ì§‘í•©ë‹ˆë‹¤. ì›¨ì–´ëŸ¬ë¸”, ì„¤ë¬¸, ë°”ì´ì˜¤ë§ˆì»¤ ë“±.
              </div>
              <div class="source-examples">
                <span class="source-example-tag">ì›¨ì–´ëŸ¬ë¸”</span>
                <span class="source-example-tag">EMA/ì„¤ë¬¸</span>
                <span class="source-example-tag">ë°”ì´ì˜¤ë§ˆì»¤</span>
                <span class="source-example-tag">ì°¸ì—¬ì ì…ë ¥</span>
              </div>
            </div>
          </div>

          <!-- ëª¨ë“œ ì¸ë””ì¼€ì´í„° -->
          <div class="mode-indicator mode-mixed" id="mode-indicator">
            ğŸ”„ Mixed-Methods â€” ê¸°ì¡´ ë°ì´í„° ê¸°ë°˜ + ì¶”ê°€ ìˆ˜ì§‘ (ê°€ì¥ í’ë¶€í•œ ì—°êµ¬ ì„¤ê³„)
          </div>

          <!-- ===== íŒ¨ë„ A: ê¸°ì¡´ ë°ì´í„° ì„¤ì • ===== -->
          <div class="panel-content" id="panel-a">
            <div class="section-label" style="margin-bottom: 12px;">A. ê¸°ì¡´ ë°ì´í„° ì†ŒìŠ¤ ì„¤ì •</div>

            <!-- CDM í…Œì´ë¸” ì„ íƒ -->
            <div class="card">
              <div class="card-header card-header-a">
                <h3>ğŸ“Š ë°ì´í„° í…Œì´ë¸” ì„ íƒ</h3>
                <span class="cdm-badge">OMOP CDM</span>
              </div>
              <div class="card-body">
                <div class="cdm-table-grid">
                  <div class="cdm-table-item selected" onclick="this.classList.toggle('selected')">
                    <div class="tbl-icon">ğŸ‘¤</div>
                    <div class="tbl-name">Person</div>
                    <div class="tbl-desc">ì¸êµ¬í†µê³„ ì •ë³´</div>
                    <div class="tbl-count">124,500 records</div>
                  </div>
                  <div class="cdm-table-item selected" onclick="this.classList.toggle('selected')">
                    <div class="tbl-icon">ğŸ©º</div>
                    <div class="tbl-name">Condition</div>
                    <div class="tbl-desc">ì§„ë‹¨/ì§ˆí™˜ ê¸°ë¡</div>
                    <div class="tbl-count">892,100 records</div>
                  </div>
                  <div class="cdm-table-item selected" onclick="this.classList.toggle('selected')">
                    <div class="tbl-icon">ğŸ’Š</div>
                    <div class="tbl-name">Drug</div>
                    <div class="tbl-desc">ì²˜ë°©/íˆ¬ì•½ ê¸°ë¡</div>
                    <div class="tbl-count">2,340,000 records</div>
                  </div>
                  <div class="cdm-table-item" onclick="this.classList.toggle('selected')">
                    <div class="tbl-icon">ğŸ”¬</div>
                    <div class="tbl-name">Measurement</div>
                    <div class="tbl-desc">ê²€ì‚¬ ê²°ê³¼ (Lab)</div>
                    <div class="tbl-count">5,120,000 records</div>
                  </div>
                  <div class="cdm-table-item" onclick="this.classList.toggle('selected')">
                    <div class="tbl-icon">ğŸ¥</div>
                    <div class="tbl-name">Visit</div>
                    <div class="tbl-desc">ë‚´ì›/ì…ì› ê¸°ë¡</div>
                    <div class="tbl-count">456,200 records</div>
                  </div>
                  <div class="cdm-table-item" onclick="this.classList.toggle('selected')">
                    <div class="tbl-icon">ğŸ“‹</div>
                    <div class="tbl-name">Observation</div>
                    <div class="tbl-desc">ê´€ì°° ë°ì´í„°</div>
                    <div class="tbl-count">1,890,000 records</div>
                  </div>
                </div>
              </div>
            </div>

            <!-- ê¸°ê°„ ì„¤ì • -->
            <div class="card">
              <div class="card-header card-header-a">
                <h3>ğŸ“… ë°ì´í„° ê¸°ê°„</h3>
              </div>
              <div class="card-body">
                <div class="date-range">
                  <input type="text" class="date-input" value="2020-01-01" />
                  <span class="date-sep">~</span>
                  <input type="text" class="date-input" value="2025-12-31" />
                  <span style="font-size:12px; color:#64748b; margin-left:8px;">6ë…„ê°„</span>
                </div>
              </div>
            </div>

            <!-- ì½”í˜¸íŠ¸ í•„í„° -->
            <div class="card">
              <div class="card-header card-header-a">
                <h3>ğŸ¯ ì½”í˜¸íŠ¸ í•„í„°</h3>
                <span class="ai-badge">AI ì¶”ì²œ ì¡°ê±´</span>
              </div>
              <div class="card-body">
                <div class="filter-row">
                  <select class="filter-field">
                    <option>Condition</option>
                    <option>Drug</option>
                    <option>Measurement</option>
                    <option>Age</option>
                  </select>
                  <select class="filter-op">
                    <option>contains</option>
                    <option>=</option>
                    <option>â‰¥</option>
                    <option>â‰¤</option>
                  </select>
                  <input type="text" class="filter-val" value="Type 2 Diabetes Mellitus" />
                  <span class="filter-remove" onclick="this.parentElement.remove()">âœ•</span>
                </div>
                <div class="filter-row">
                  <select class="filter-field">
                    <option>Age</option>
                  </select>
                  <select class="filter-op">
                    <option>â‰¥</option>
                  </select>
                  <input type="text" class="filter-val" value="30" />
                  <span class="filter-remove" onclick="this.parentElement.remove()">âœ•</span>
                </div>
                <div class="filter-row">
                  <select class="filter-field">
                    <option selected>Drug</option>
                  </select>
                  <select class="filter-op">
                    <option selected>contains</option>
                  </select>
                  <input type="text" class="filter-val" value="Metformin" />
                  <span class="filter-remove" onclick="this.parentElement.remove()">âœ•</span>
                </div>
                <button class="add-filter-btn">+ ì¡°ê±´ ì¶”ê°€</button>

                <!-- ë°ì´í„° í”„ë¦¬ë·° -->
                <div class="data-preview" style="margin-top: 16px;">
                  <div class="preview-stat">
                    <div class="preview-num">2,340</div>
                    <div class="preview-label">í•´ë‹¹ í™˜ì ìˆ˜</div>
                  </div>
                  <div class="preview-divider"></div>
                  <div class="preview-stat">
                    <div class="preview-num" style="font-size:22px;">186K</div>
                    <div class="preview-label">ì´ ë ˆì½”ë“œ</div>
                  </div>
                  <div class="preview-divider"></div>
                  <div class="preview-chart">
                    <div class="preview-bar" style="height:20%"></div>
                    <div class="preview-bar" style="height:35%"></div>
                    <div class="preview-bar" style="height:45%"></div>
                    <div class="preview-bar" style="height:60%"></div>
                    <div class="preview-bar" style="height:80%"></div>
                    <div class="preview-bar" style="height:100%"></div>
                    <div class="preview-bar" style="height:95%"></div>
                    <div class="preview-bar" style="height:85%"></div>
                    <div class="preview-bar" style="height:70%"></div>
                    <div class="preview-bar" style="height:55%"></div>
                    <div class="preview-bar" style="height:40%"></div>
                    <div class="preview-bar" style="height:30%"></div>
                  </div>
                  <div class="preview-stat">
                    <div class="preview-label">ì—°ë„ë³„ ë¶„í¬</div>
                    <div style="font-size:10px; color:#94a3b8;">2020â€“2025</div>
                  </div>
                </div>
              </div>
            </div>

            <!-- Mixed ëª¨ë“œì¼ ë•Œ ì—°ê²° í™”ì‚´í‘œ -->
            <div id="flow-connector" class="flow-arrow">
              â¬‡ï¸
              <div style="text-align:center;">
                <span class="flow-label">ìœ„ ì½”í˜¸íŠ¸ì—ì„œ ì¶”ê°€ ìˆ˜ì§‘ ëŒ€ìƒ ì„ ë³„</span>
              </div>
            </div>
          </div>

          <!-- ===== íŒ¨ë„ B: ì‹ ê·œ ìˆ˜ì§‘ ì„¤ì • ===== -->
          <div class="panel-content" id="panel-b">
            <div class="section-label" style="margin-bottom: 12px;">B. ì‹ ê·œ ë°ì´í„° ìˆ˜ì§‘ ì„¤ê³„</div>

            <!-- íŒ¨ì‹œë¸Œ ë°ì´í„° -->
            <div class="card">
              <div class="card-header card-header-b">
                <h3>ğŸ“¡ íŒ¨ì‹œë¸Œ ë°ì´í„° (ìë™ ìˆ˜ì§‘)</h3>
                <span class="ai-badge">AI ì¶”ì²œ</span>
              </div>
              <div class="card-body">
                <div class="data-grid">
                  <div class="data-item selected" onclick="this.classList.toggle('selected'); updateBurden();">
                    <div class="icon">âŒš</div>
                    <div class="info">
                      <div class="name">ì›¨ì–´ëŸ¬ë¸” ë””ë°”ì´ìŠ¤</div>
                      <div class="desc">ì‹¬ë°•ìˆ˜, ê±¸ìŒìˆ˜, ìˆ˜ë©´, í™œë™ëŸ‰</div>
                    </div>
                  </div>
                  <div class="data-item selected" onclick="this.classList.toggle('selected'); updateBurden();">
                    <div class="icon">ğŸ“</div>
                    <div class="info">
                      <div class="name">ìœ„ì¹˜/í™˜ê²½ ë°ì´í„°</div>
                      <div class="desc">ì´ë™íŒ¨í„´, ê¸°ì˜¨, ìŠµë„</div>
                    </div>
                  </div>
                  <div class="data-item" onclick="this.classList.toggle('selected'); updateBurden();">
                    <div class="icon">ğŸ“±</div>
                    <div class="info">
                      <div class="name">ì•± ì‚¬ìš© íŒ¨í„´</div>
                      <div class="desc">ìŠ¤í¬ë¦°íƒ€ì„, ì•± ì¹´í…Œê³ ë¦¬</div>
                    </div>
                  </div>
                  <div class="data-item" onclick="this.classList.toggle('selected'); updateBurden();">
                    <div class="icon">ğŸ©¸</div>
                    <div class="info">
                      <div class="name">ì—°ì† ì¸¡ì • ë””ë°”ì´ìŠ¤</div>
                      <div class="desc">CGM, í˜ˆì••ê³„, ì²´ì„±ë¶„ê³„ ë“±</div>
                    </div>
                  </div>
                </div>
              </div>
            </div>

            <!-- ì•¡í‹°ë¸Œ ë°ì´í„° (EMA) -->
            <div class="card">
              <div class="card-header card-header-b">
                <h3>âœï¸ ì•¡í‹°ë¸Œ ë°ì´í„° (ì°¸ì—¬ì ì…ë ¥)</h3>
              </div>
              <div class="card-body">
                <div class="data-grid">
                  <div class="data-item selected" onclick="this.classList.toggle('selected'); updateBurden();">
                    <div class="icon">ğŸ½ï¸</div>
                    <div class="info">
                      <div class="name">ì‹ë‹¨ ê¸°ë¡</div>
                      <div class="desc">ì‹ì‚¬ ì‚¬ì§„, ì˜ì–‘ ì •ë³´</div>
                    </div>
                  </div>
                  <div class="data-item selected" onclick="this.classList.toggle('selected'); updateBurden();">
                    <div class="icon">ğŸ’Š</div>
                    <div class="info">
                      <div class="name">ë³µì•½ ê¸°ë¡</div>
                      <div class="desc">ì•½ëª…, ìš©ëŸ‰, ë³µìš© ì‹œê°„</div>
                    </div>
                  </div>
                  <div class="data-item" onclick="this.classList.toggle('selected'); updateBurden();">
                    <div class="icon">ğŸ˜Š</div>
                    <div class="info">
                      <div class="name">ê¸°ë¶„/ì¦ìƒ ì²´í¬</div>
                      <div class="desc">EMA ë°©ì‹ ë°˜ë³µ ì¸¡ì •</div>
                    </div>
                  </div>
                  <div class="data-item" onclick="this.classList.toggle('selected'); updateBurden();">
                    <div class="icon">ğŸ““</div>
                    <div class="info">
                      <div class="name">ì¼ì§€/ë‹¤ì´ì–´ë¦¬</div>
                      <div class="desc">ììœ  í…ìŠ¤íŠ¸, ìŒì„± ë©”ëª¨</div>
                    </div>
                  </div>
                </div>

                <!-- EMA ë¹ˆë„ ì„¤ì • -->
                <div class="ema-section">
                  <div style="font-size:13px; font-weight:600; margin-bottom:10px;">ğŸ“Š ìˆ˜ì§‘ ë¹ˆë„ ì„¤ì •</div>
                  <div class="ema-row">
                    <div class="ema-name">ğŸ½ï¸ ì‹ë‹¨ ê¸°ë¡</div>
                    <input type="text" class="ema-freq" value="3íšŒ/ì¼" />
                    <span class="ema-timing">ë§¤ ì‹ì‚¬ í›„</span>
                  </div>
                  <div class="ema-row">
                    <div class="ema-name">ğŸ’Š ë³µì•½ ê¸°ë¡</div>
                    <input type="text" class="ema-freq" value="2íšŒ/ì¼" />
                    <span class="ema-timing">ì•„ì¹¨, ì €ë…</span>
                  </div>
                </div>
              </div>
            </div>

            <!-- ì°¸ì—¬ì ë¶€ë‹´ë„ -->
            <div class="burden-meter" id="burden-meter">
              <div style="display:flex; justify-content:space-between; align-items:center;">
                <div style="font-size:13px; font-weight:600;">âš–ï¸ ì°¸ì—¬ì ë¶€ë‹´ë„</div>
                <div style="font-size:20px; font-weight:800; color:#f59e0b;" id="burden-score">5.2/10</div>
              </div>
              <div class="burden-bar-bg">
                <div class="burden-bar-fill burden-mid" id="burden-bar" style="width: 52%;"></div>
              </div>
              <div class="burden-label">
                <span>ë‚®ìŒ (íŒ¨ì‹œë¸Œ ìœ„ì£¼)</span>
                <span>ë†’ìŒ (8+ í”„ë¡¬í”„íŠ¸/ì¼)</span>
              </div>
              <div style="font-size:11px; color:#d97706; margin-top:6px;">
                âš ï¸ í•˜ë£¨ 5íšŒ ì…ë ¥ ìš”êµ¬ â€” íƒˆë½ë¥  15-20% ì˜ˆìƒ
              </div>
            </div>
          </div>

        </div>

        <!-- ìš°ì¸¡ AI íŒ¨ë„ -->
        <div class="ai-panel">
          <div class="ai-panel-title">ğŸ¤– AI ë°ì´í„° ì–´ë“œë°”ì´ì €</div>

          <div class="ai-suggestion" id="ai-suggestion-mode">
            <div class="ai-suggestion-title">í˜„ì¬ ëª¨ë“œ ë¶„ì„</div>
            <div class="ai-suggestion-text" id="ai-mode-text">
              <span class="highlight">Mixed-Methods</span> ì„¤ê³„ì…ë‹ˆë‹¤.
              ê¸°ì¡´ EMR ì½”í˜¸íŠ¸(2,340ëª…)ì—ì„œ ì¡°ê±´ì— ë§ëŠ” ëŒ€ìƒìë¥¼ ì„ ë³„í•œ í›„,
              ì¶”ê°€ ì›¨ì–´ëŸ¬ë¸”+ì„¤ë¬¸ ë°ì´í„°ë¥¼ ìˆ˜ì§‘í•˜ëŠ” êµ¬ì¡°ì…ë‹ˆë‹¤.
            </div>
            <div class="ai-impact impact-blue">
              â„¹ï¸ IRB: ì¼ë°˜ ì‹¬ì˜ í•„ìš” (ì‹ ê·œ ìˆ˜ì§‘ í¬í•¨)
            </div>
          </div>

          <div class="ai-suggestion">
            <div class="ai-suggestion-title">ë°ì´í„° ì»¤ë²„ë¦¬ì§€</div>
            <div class="ai-suggestion-text">
              Step 2ì—ì„œ ì„¤ì •í•œ <span class="highlight">Primary Outcome</span>ì„ ì¸¡ì •í•˜ê¸° ìœ„í•´
              ìµœì†Œ Condition + Measurement í…Œì´ë¸”ì´ í•„ìš”í•©ë‹ˆë‹¤.
              í˜„ì¬ 3ê°œ í…Œì´ë¸” ì„ íƒë¨.
            </div>
            <div class="ai-impact impact-green">
              âœ… ì—°êµ¬ ì„¤ê³„ ìš”êµ¬ì‚¬í•­ ì¶©ì¡±
            </div>
          </div>

          <div class="ai-suggestion">
            <div class="ai-suggestion-title">IRB ë„“ê²Œ ì¡ê¸° íŒ</div>
            <div class="ai-suggestion-text">
              í˜„ì¬ ë°ì´í„° í•­ëª© ê¸°ì¤€ìœ¼ë¡œ IRBë¥¼ ì‘ì„±í•˜ë˜, í–¥í›„ ì¶”ê°€ ê°€ëŠ¥í•œ í•­ëª©ë„ ë¯¸ë¦¬ í¬í•¨í•˜ì„¸ìš”.
              <span class="highlight">Measurement í…Œì´ë¸”</span>ì„ ì§€ê¸ˆ ì¶”ê°€í•˜ë©´
              Lab ë°ì´í„° ë¶„ì„ë„ IRB ì¬ìŠ¹ì¸ ì—†ì´ ê°€ëŠ¥í•©ë‹ˆë‹¤.
            </div>
            <div class="ai-impact impact-yellow">
              ğŸ’¡ ì¶”ì²œ: Measurement í…Œì´ë¸”ë„ ì„ íƒ
            </div>
          </div>

          <div class="ai-suggestion" id="ai-mixed-tip" style="border-left: 3px solid #f59e0b;">
            <div class="ai-suggestion-title">Mixed-Methods ì„¤ê³„ ì°¸ê³ </div>
            <div class="ai-suggestion-text">
              ê¸°ì¡´ ì½”í˜¸íŠ¸ì—ì„œ ì¶”ê°€ ìˆ˜ì§‘ ëŒ€ìƒì„ ì„ ë³„í•  ë•Œ,
              <span class="highlight">Step 4</span>ì—ì„œ ì½”í˜¸íŠ¸ â†’ ëª¨ì§‘ ëŒ€ìƒ ì „í™˜ì´ ìë™ ì—°ê³„ë©ë‹ˆë‹¤.
              í˜„ì¬ ì½”í˜¸íŠ¸ 2,340ëª… ì¤‘ ì¶”ê°€ ìˆ˜ì§‘ ì¡°ê±´ì— ë§ëŠ” ëŒ€ìƒì„ í•„í„°ë§í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
            </div>
          </div>
        </div>
      </div>

      <!-- í•˜ë‹¨ ìš”ì•½ ë°” -->
      <div class="summary-bar">
        <div class="summary-chips" id="summary-chips">
          <span class="chip-a">ğŸ—„ï¸ ê¸°ì¡´: Person + Condition + Drug (2,340ëª…)</span>
          <span class="chip-b">ğŸ“± ì‹ ê·œ: ì›¨ì–´ëŸ¬ë¸” + ì‹ë‹¨ + ë³µì•½ (5íšŒ/ì¼)</span>
          <span class="chip-neutral">ğŸ”„ Mixed-Methods</span>
        </div>
        <div class="nav-buttons">
          <button class="btn-secondary">â† ì—°êµ¬ ì„¤ê³„</button>
          <button class="btn-primary" id="next-btn">íƒ€ê²Ÿ ì„¤ì • â†’</button>
        </div>
      </div>
    </div>
  </div>

  <script>
    let sourceA = true;
    let sourceB = true;

    function toggleSource(source) {
      if (source === 'a') {
        sourceA = !sourceA;
      } else {
        sourceB = !sourceB;
      }
      updateUI();
    }

    function updateUI() {
      const cardA = document.getElementById('card-a');
      const cardB = document.getElementById('card-b');
      const toggleA = document.getElementById('toggle-a');
      const toggleB = document.getElementById('toggle-b');
      const panelA = document.getElementById('panel-a');
      const panelB = document.getElementById('panel-b');
      const modeIndicator = document.getElementById('mode-indicator');
      const flowConnector = document.getElementById('flow-connector');
      const summaryChips = document.getElementById('summary-chips');
      const aiModeText = document.getElementById('ai-mode-text');
      const aiMixedTip = document.getElementById('ai-mixed-tip');
      const burdenMeter = document.getElementById('burden-meter');
      const step4Label = document.getElementById('step4-label');
      const nextBtn = document.getElementById('next-btn');

      // Toggle visuals
      cardA.className = sourceA ? 'source-toggle active-a' : 'source-toggle';
      cardB.className = sourceB ? 'source-toggle active-b' : 'source-toggle';
      toggleA.className = sourceA ? 'toggle-switch on' : 'toggle-switch';
      toggleB.className = sourceB ? 'toggle-switch on-b' : 'toggle-switch';

      // Panels
      panelA.className = sourceA ? 'panel-content' : 'panel-content hidden';
      panelB.className = sourceB ? 'panel-content' : 'panel-content hidden';
      flowConnector.style.display = (sourceA && sourceB) ? 'block' : 'none';
      burdenMeter.style.display = sourceB ? 'block' : 'none';
      aiMixedTip.style.display = (sourceA && sourceB) ? 'block' : 'none';

      // Mode indicator
      if (sourceA && sourceB) {
        modeIndicator.className = 'mode-indicator mode-mixed';
        modeIndicator.innerHTML = 'ğŸ”„ Mixed-Methods â€” ê¸°ì¡´ ë°ì´í„° ê¸°ë°˜ + ì¶”ê°€ ìˆ˜ì§‘ (ê°€ì¥ í’ë¶€í•œ ì—°êµ¬ ì„¤ê³„)';
        summaryChips.innerHTML = `
          <span class="chip-a">ğŸ—„ï¸ ê¸°ì¡´: Person + Condition + Drug (2,340ëª…)</span>
          <span class="chip-b">ğŸ“± ì‹ ê·œ: ì›¨ì–´ëŸ¬ë¸” + ì‹ë‹¨ + ë³µì•½ (5íšŒ/ì¼)</span>
          <span class="chip-neutral">ğŸ”„ Mixed-Methods</span>
        `;
        aiModeText.innerHTML = '<span class="highlight">Mixed-Methods</span> ì„¤ê³„ì…ë‹ˆë‹¤. ê¸°ì¡´ EMR ì½”í˜¸íŠ¸(2,340ëª…)ì—ì„œ ì¡°ê±´ì— ë§ëŠ” ëŒ€ìƒìë¥¼ ì„ ë³„í•œ í›„, ì¶”ê°€ ì›¨ì–´ëŸ¬ë¸”+ì„¤ë¬¸ ë°ì´í„°ë¥¼ ìˆ˜ì§‘í•˜ëŠ” êµ¬ì¡°ì…ë‹ˆë‹¤.';
        document.querySelector('#ai-suggestion-mode .ai-impact').className = 'ai-impact impact-blue';
        document.querySelector('#ai-suggestion-mode .ai-impact').innerHTML = 'â„¹ï¸ IRB: ì¼ë°˜ ì‹¬ì˜ í•„ìš” (ì‹ ê·œ ìˆ˜ì§‘ í¬í•¨)';
        step4Label.textContent = 'ì½”í˜¸íŠ¸â†’ëª¨ì§‘';
        nextBtn.textContent = 'ì½”í˜¸íŠ¸â†’ëª¨ì§‘ ì„¤ì • â†’';
      } else if (sourceA && !sourceB) {
        modeIndicator.className = 'mode-indicator mode-retro';
        modeIndicator.innerHTML = 'ğŸ—„ï¸ Retrospective â€” ê¸°ì¡´ ë°ì´í„°ë§Œ ì‚¬ìš© (ì°¸ì—¬ì ëª¨ì§‘ ë¶ˆí•„ìš”, IRB ê°„ì†Œí™”)';
        summaryChips.innerHTML = `
          <span class="chip-a">ğŸ—„ï¸ ê¸°ì¡´: Person + Condition + Drug (2,340ëª…)</span>
          <span class="chip-neutral">ğŸ—„ï¸ Retrospective</span>
        `;
        aiModeText.innerHTML = '<span class="highlight">Retrospective</span> ì„¤ê³„ì…ë‹ˆë‹¤. ê¸°ì¡´ EMR ë°ì´í„°ë§Œ ì‚¬ìš©í•˜ë¯€ë¡œ ì°¸ì—¬ì ëª¨ì§‘ì´ ë¶ˆí•„ìš”í•˜ë©°, IRB ë©´ì œ ë˜ëŠ” ê°„ì´ ì‹¬ì˜ ê°€ëŠ¥ì„±ì´ ë†’ìŠµë‹ˆë‹¤.';
        document.querySelector('#ai-suggestion-mode .ai-impact').className = 'ai-impact impact-green';
        document.querySelector('#ai-suggestion-mode .ai-impact').innerHTML = 'âœ… IRB: ë©´ì œ/ê°„ì´ ê°€ëŠ¥ì„± ë†’ìŒ';
        step4Label.textContent = 'ì½”í˜¸íŠ¸ ì •ì˜';
        nextBtn.textContent = 'ì½”í˜¸íŠ¸ ì •ì˜ â†’';
      } else if (!sourceA && sourceB) {
        modeIndicator.className = 'mode-indicator mode-pro';
        modeIndicator.innerHTML = 'ğŸ“± Prospective â€” ìƒˆ ë°ì´í„° ìˆ˜ì§‘ (ì°¸ì—¬ì ëª¨ì§‘ + IRB ì¼ë°˜ ì‹¬ì˜ í•„ìš”)';
        summaryChips.innerHTML = `
          <span class="chip-b">ğŸ“± ì‹ ê·œ: ì›¨ì–´ëŸ¬ë¸” + ì‹ë‹¨ + ë³µì•½ (5íšŒ/ì¼)</span>
          <span class="chip-neutral">ğŸ“± Prospective</span>
        `;
        aiModeText.innerHTML = '<span class="highlight">Prospective</span> ì„¤ê³„ì…ë‹ˆë‹¤. ì°¸ì—¬ìë¥¼ ìƒˆë¡œ ëª¨ì§‘í•˜ì—¬ ë°ì´í„°ë¥¼ ìˆ˜ì§‘í•©ë‹ˆë‹¤. IRB ì¼ë°˜ ì‹¬ì˜ê°€ í•„ìš”í•˜ë©°, ì°¸ì—¬ì ë³´ìƒ ì—ìŠ¤í¬ë¡œê°€ í•„ìš”í•©ë‹ˆë‹¤.';
        document.querySelector('#ai-suggestion-mode .ai-impact').className = 'ai-impact impact-yellow';
        document.querySelector('#ai-suggestion-mode .ai-impact').innerHTML = 'âš ï¸ IRB: ì¼ë°˜ ì‹¬ì˜ í•„ìš” + ì°¸ì—¬ì ë³´ìƒ';
        step4Label.textContent = 'ì°¸ì—¬ì ëª¨ì§‘';
        nextBtn.textContent = 'ì°¸ì—¬ì ëª¨ì§‘ â†’';
      } else {
        modeIndicator.className = 'mode-indicator mode-none';
        modeIndicator.innerHTML = 'â¬œ ë°ì´í„° ì†ŒìŠ¤ë¥¼ ì„ íƒí•´ì£¼ì„¸ìš”';
        summaryChips.innerHTML = '<span class="chip-neutral">ë°ì´í„° ì†ŒìŠ¤ ë¯¸ì„ íƒ</span>';
        aiModeText.innerHTML = 'ë°ì´í„° ì†ŒìŠ¤ë¥¼ í•˜ë‚˜ ì´ìƒ í™œì„±í™”í•´ì£¼ì„¸ìš”.';
        step4Label.textContent = 'íƒ€ê²Ÿ ì„¤ì •';
        nextBtn.textContent = 'ë‹¤ìŒ â†’';
      }
    }

    function updateBurden() {
      // Simple burden calculation
      const selected = document.querySelectorAll('#panel-b .data-item.selected').length;
      const score = Math.min(10, selected * 1.3 + 1.5).toFixed(1);
      document.getElementById('burden-score').textContent = score + '/10';
      const pct = (score / 10 * 100);
      const bar = document.getElementById('burden-bar');
      bar.style.width = pct + '%';
      bar.className = 'burden-bar-fill ' + (pct < 40 ? 'burden-low' : pct < 70 ? 'burden-mid' : 'burden-high');
    }
  </script>
</body>
</html>
