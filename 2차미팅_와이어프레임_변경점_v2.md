# 와이어프레임 변경점 v2 — 비판적 분석 포함

> **작성일:** 2026-02-15
> **기준:** 2차 미팅 피드백 + 후속 설계 논의 종합
> **v1 대비 변경:** 모드 분리 접근 → 통합 타임라인 접근으로 전면 재검토

---

## 1. 논의 과정에서 진화한 생각들

우리가 대화하면서 생각이 세 번 바뀌었다. 이 과정 자체를 정리한다.

### Round 1: "Retro/Pro 모드를 분리하자"

내가(Claude) 처음 제안한 것:
- create.html에 연구 유형 분기점 추가
- Step 3~6을 Retrospective 모드 / Prospective 모드로 이중 설계
- 각 모드별 다른 UI 레이아웃

**이 접근의 문제 (승헌 지적):**
> "레트로스펙티브와 프로스펙티브 레이아웃이 다르면 안 될 거 같다"

맞다. 연구가 진행 중에 모드가 바뀔 수 있다. Overview/Table이 모드마다 다르게 생기면, 모드 전환할 때마다 UI가 확 바뀌어 혼란스럽다. 그리고 개발 비용이 사실상 2배.

### Round 2: "카드 A/B 토글로 레이어링하자"

내가 수정 제안한 것:
- Step 3에서 "기존 데이터" 카드 A와 "신규 수집" 카드 B를 독립적으로 on/off
- A만 ON = Retro, B만 ON = Pro, 둘 다 ON = Mixed
- Overview/Table은 하나의 통합 레이아웃 + 소스 태그

**이 접근의 문제 (승헌 지적):**
> "데이터를 켜고 꺼야 한다고? 쉣인데?"

맞다. 토글 자체가 연구자한테 부담이다. "설정"을 하게 만드는 건 우리가 해결해야 할 일을 연구자한테 떠넘기는 거다.

### Round 3: "시간 축이 모든 걸 통합한다"

승헌의 핵심 인사이트:
> "Prospective로 수집한 데이터도 시간이 지나면 과거 데이터가 된다"
> "Retro/Pro는 고정된 유형이 아니라, '지금' 기준 상대적 개념이다"

따라서:
- Retro/Pro 구분 자체가 UI에서 불필요
- 모든 데이터는 타임라인 위에 존재
- 시스템이 시간 축을 자동으로 잡아줌
- 연구자는 데이터 소스를 연결하고, 탐색만 함

---

## 2. 비판적 분석: 내가(Claude) 틀렸던 것

### ❌ 모드 기반 사고에서 벗어나지 못했다

v1 문서 전체가 "Retrospective 모드에서는…" "Prospective 모드에서는…"으로 시작한다. 이건 Yohan의 "레트로와 프로를 나눠서 가는 게 맞지 않을까?"라는 발언을 너무 문자적으로 해석한 거다.

Yohan이 말한 건 **"두 유형의 현실적 차이를 인지해라"**였지, **"UI를 두 가지로 쪼개라"**가 아니었다. 나는 "차이를 인지"를 "모드를 분리"로 오해했다.

### ❌ Index Date + 멀티 앵커 + 줌/패닝 — 과도한 설계

시간 축 문제를 인식한 건 좋았지만, 해결책으로 "멀티 앵커 선택", "줌 레벨 조절", "시간 윈도우 슬라이더" 같은 걸 제안했다. 이건 연구자한테 또 다른 설정 부담을 지우는 거다.

승헌이 "이 모든 걸 한 번에 처리해줘야 함"이라고 한 게 정확하다. 시스템이 데이터를 보고 자동으로 시간 축을 결정해야 한다.

### ❌ Step 3 v2 와이어프레임 — 이미 구식

방금 만든 create-step3-v2.html은 카드 A/B 토글 기반이다. Round 3 결론과 이미 맞지 않는다. 다시 만들어야 한다.

---

## 3. 비판적 분석: 승헌이 제기한 것 중 주의할 점

### "전부 자동"은 전제다

시간 축 자동 감지, 해상도 자동 조절, 데이터 소스별 시각화 자동 레이어링 — **이것이 이 플랫폼의 기술적 핵심이다.** 이걸 만드는 게 우리의 일이지, "어렵다"고 타협할 대상이 아니다.

구체적으로 AI가 해결할 것:
- EMR 데이터의 불규칙 시간 간격 → AI가 데이터 밀도를 분석하여 적절한 시각화 해상도 자동 결정
- 분기선 자동 감지 → 데이터 소스의 시작/종료 타임스탬프를 기반으로 자동 생성
- 서로 다른 시간 해상도 → 소스 특성에 맞는 시각화 타입 자동 매칭 (이벤트=점, 연속=라인, 이산=바)

이것은 목표가 아니라 **전제**다.

### ⚠️ "Retro/Pro 구분이 UI에서 사라져야 한다" vs IRB 현실

UI에서 구분을 없애는 건 맞다. 하지만 **IRB 프로세스에서는 구분이 필수**다. 기존 데이터만 쓰면 면제, 새로 사람한테 수집하면 일반 심의. 이건 법적 요구사항이지 UX 철학이 아니다.

따라서 UI에서는 구분하지 않되, **시스템이 내부적으로 자동 판단**해서 Step 5(IRB)에서 적절한 심의 유형을 추천해야 한다. 연구자가 "나는 레트로야"라고 선언할 필요 없이, 연결된 데이터 소스를 보고 시스템이 "기존 데이터만 사용 → 면제 가능성 높음" 또는 "신규 수집 포함 → 일반 심의 필요"를 자동 판단.

### ⚠️ 스코프 확대 위험

대화가 진행될수록 요구사항이 더 정교해지고 있다. "시간 축 자동 감지", "데이터 레이어 자동 시각화", "IRB 자동 판단" — 각각이 사소하지 않은 기능이다.

Yohan: "페인포인트 하나를 명확하게 잡아서 깊게 확실하게 해결하라"
김정연: "명확한 하나에만 집중해서"

이 조언과 현재 우리가 그리고 있는 그림 사이에 괴리가 있다.

---

## 4. 종합: 새로운 설계 원칙

위의 비판을 모두 수용하면, 설계 원칙은 이렇게 정리된다.

### 원칙 1: 데이터는 전부 시간 위에 존재한다

Retro/Pro/Mixed 같은 "모드"는 없다. 모든 데이터는 타임라인 위의 점이다. 과거 EMR이든 오늘 수집된 웨어러블이든 내일 들어올 EMA 응답이든. 유일한 차이는 타임스탬프다.

### 원칙 2: 연구자는 연결하고, 탐색한다

연구자가 하는 행위는 두 가지뿐이다:
- **연결:** 데이터 소스를 연구에 붙인다 (EMR, 웨어러블, 설문 등)
- **탐색:** 타임라인 위의 데이터를 본다

설정, 토글, 모드 선택, 앵커 지정, 해상도 조절 — 전부 시스템이 한다.

### 원칙 3: 시간 축은 시스템이 자동으로 잡는다

- 데이터 소스가 연결되면 → 시간 범위 자동 감지
- 과거 데이터 + 신규 수집 → 분기선 자동 생성
- 데이터 밀도에 따라 → 시각화 해상도 자동 조절
- 신규 수집 데이터가 쌓이면 → 타임라인이 자동 확장

### 원칙 4: IRB는 시스템이 내부적으로 판단한다

연결된 데이터 소스를 보고:
- 기존 데이터만 → "면제/간이 가능성 높음" 자동 안내
- 신규 수집 포함 → "일반 심의 필요" 자동 안내
- 연구자가 유형을 선언할 필요 없음

### 원칙 5: 하나의 뷰, 레이어로 쌓인다

Overview와 Table은 단일 레이아웃이다. 데이터 소스가 추가되면 레이어가 쌓인다. 컬럼이 늘어나고, 타임라인 위에 새 데이터 라인이 겹친다. UI 구조는 변하지 않는다.

---

## 5. 이 원칙 기반 페이지별 변경 방향 (v2)

### Step 1: AI 인터뷰 (create.html)
- **변경 없음의 수준:** 큰 구조 유지
- **수정:** 연구 유형 분기점 제거. AI 인터뷰에서 자연스럽게 연구 맥락 파악
- **수정:** 6스텝 비선형 네비게이션 전환
- **수정:** 당뇨 외 다양한 예시

### Step 2: 연구 설계 (create-step2.html)
- **변경 없음의 수준:** 큰 구조 유지
- **수정:** 당뇨 특화 → 범용 플레이스홀더
- **수정:** IRB 넓게 잡기 가이드 추가
- 이 스텝은 Retro든 Pro든 동일하게 적용됨 (가설/방법론/참여자 조건은 연구 유형 무관)

### Step 3: 데이터 소스 연결 (create-step3.html) ← 이름 변경
- **v1:** "데이터 수집" → **v2:** "데이터 소스 연결"
- **v1:** 카드 A/B 토글 (Retro/Pro 분리) → **v2:** 통합 소스 목록
- **구조:** 사용 가능한 데이터 소스를 전부 보여주고, 연구자가 필요한 걸 연결
  - 기존 데이터: EMR/CDM 테이블 연결, 기간 설정, 코호트 필터
  - 신규 수집: 웨어러블, EMA, 바이오마커 등
  - 둘 다 같은 목록에 있음. "기존"이냐 "신규"냐는 소스의 속성이지 모드가 아님
- **시간:** 각 소스를 연결할 때 시간 범위가 자동으로 표시됨
  - EMR 연결 → "2020.01 ~ 2025.12 데이터 감지"
  - 웨어러블 시작 → "2026.02.15~ 수집 시작"
  - 시스템이 전체 시간 범위를 자동 통합
- **EMA 빈도 / 참여자 부담도:** 신규 수집 소스가 하나라도 있으면 자동 표시 (토글 아님)

### Step 4: 대상 정의 (create-step4.html) ← 이름 변경
- **v1:** 모집이냐 코호트냐 모드별 분기 → **v2:** 통합
- **구조:**
  - 포함/제외 기준 설정 (모든 연구에 공통)
  - 기존 데이터 연결되어 있으면 → 해당 기준에 맞는 기존 데이터 볼륨 자동 표시
  - 신규 수집 소스 있으면 → 모집 설정 섹션이 자동으로 나타남
  - 둘 다 있으면 → 기존 코호트에서 추가 수집 대상 선별 UI 자동 표시

### Step 5: IRB 심의 (create-step5.html)
- **구조 유지**, 내부 로직만 변경
- 연결된 데이터 소스를 기반으로 AI가 IRB 유형 자동 판단
  - 기존 데이터만 → 면제/간이 추천
  - 신규 수집 포함 → 일반 심의 추천
- IRB 초안 자동 생성 강화
- "넓게 잡기" 전략 안내

### Step 6: 에스크로 (create-step6.html)
- **구조 유지**, 항목만 동적
- 신규 수집 소스 없으면 → 참여자 보상 행 자동 미표시
- 신규 수집 있으면 → 참여자 보상 + 모집 비용 자동 추가
- 연구자가 모드를 선택하는 게 아니라, 데이터 소스에 따라 비용 구조가 자동 결정

### data-overview.html
- **단일 레이아웃**, 레이어 구조
- 타임라인: 시스템이 자동으로 전체 시간 범위 표시
  - 과거 데이터 구간 + 진행 중 수집 구간이 하나의 축에
  - 분기선은 신규 수집 시작일 기준 자동 생성
- 시각화: 연결된 데이터 소스에 따라 자동 구성
  - 시계열 그래프 (디폴트)
  - 히스토그램 (디폴트)
  - 소스별 색상 구분
- 변수 선택: 드롭다운에 연결된 모든 변수 자동 표시 (소스 라벨 포함)
- AI 인사이트 유지

### data-table.html
- **단일 레이아웃**, 동적 컬럼
- 고정 컬럼: ID, 기본 인구통계
- 가변 컬럼: 연결된 데이터 소스에 따라 자동 추가, 소스 태그 표시
- **행 구조: 환자 × 시간 윈도우**
  - 시간 윈도우는 시스템이 데이터 밀도 기반 자동 결정
  - 데이터 없는 셀은 자연스럽게 비어 있음 (과거에 웨어러블 없었으면 빈 칸)
- 컬럼 순서/표시는 시스템 디폴트, 고급 사용자만 커스텀

### list.html
- 연구 카드에 연결된 데이터 소스 아이콘 표시 (모드 태그 대신)
  - 🗄️ EMR  📱 웨어러블  ✍️ EMA  🔬 Lab 등
- 소스 아이콘 조합 = 사실상 연구 유형을 보여주지만, "레트로/프로" 라벨은 없음

---

## 6. 여전히 미해결인 질문들

### Q1. AI 자동 판단의 투명성
시스템이 전부 자동으로 하면, 연구자가 시스템의 판단을 이해 못할 수 있다. "왜 이 시점이 분기선이지?"

→ AI 패널에서 판단 근거를 자연어로 설명. "신규 수집이 2026.02.15에 시작되어 이 시점을 기준으로 타임라인을 구성했습니다" 같은 투명한 안내. 연구자가 설정할 필요 없이, **왜 이렇게 보이는지만 이해하면 된다.**

### Q2. 스코프 결정과의 관계
이 모든 논의는 "연구 설계 도구 + 데이터 시각화"를 전제로 한다. 하지만 2차 미팅에서 "하나만 해라"라는 피드백이 있었다. 통합 타임라인 구조는 사실 "데이터 시각화 도구"에 가깝고, Step 2~6의 연구 설계 흐름은 "연구 설계 도구"에 가깝다.

→ 이 두 가지를 어떻게 잡을지는 아직 결정되지 않았다. 변호사 미팅과 추가 인터뷰 결과에 따라 방향이 달라질 수 있다.

### Q3. 시간 해상도 — 소스별 시각화 타입으로 해결
같은 타임라인에 3개월 간격 EMR + 5분 간격 웨어러블 + 하루 3회 EMA가 공존할 때 → 해상도를 하나로 통일하는 게 아니라, **소스 특성에 맞는 시각화 타입**으로 해결.

- EMR = 점 (이벤트) — 불규칙 간격 그대로
- 웨어러블 = 라인 (연속) — 줌 레벨에 따라 집계
- EMA = 바 (이산) — 고정 간격

하나의 타임라인, 서로 다른 시각화 레이어. AI가 각 소스의 데이터 특성을 분석하여 최적의 시각화 타입을 자동 매칭.

---

## 7. v1 문서에서 여전히 유효한 것

위의 재검토에도 불구하고, v1에서 변하지 않는 것들:

- ✅ 6스텝 비선형 네비게이션 전환
- ✅ 당뇨 특화 콘텐츠 범용화
- ✅ OMOP CDM 반영
- ✅ clean-room MVP 제외
- ✅ IRB 자동 생성/넓게 잡기 가이드
- ✅ AI 인사이트 패널 유지
- ✅ 107KB data-table 최적화

---

## 8. 다음 단계

1. **스코프 결정** — "연구 설계 도구" vs "데이터 시각화 도구" vs "둘 다" 결정 (변호사 미팅, 추가 인터뷰 후)
2. **Step 3 v3 와이어프레임** — 카드 A/B 토글 제거, 통합 소스 연결 UI로 재설계
3. **data-overview v2** — 통합 타임라인 + 자동 시간 축 프로토타입
4. **data-table v2** — 동적 컬럼 + 환자×시간윈도우 행 구조 프로토타입
